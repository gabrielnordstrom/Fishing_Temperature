---
title: "Figures"
author: "Gabriel"
date: "4/18/2023"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(R.matlab)
library(tidyverse)
```

### Figure 2: Fishing on predators at $18^\circ C$ and $24^\circ C$ (filename: Fig2.pdf)

```{r}
# 291.15K
lowFP <- readMat("291K_FP_NAN_mp.mat")

lowFP <- as.data.frame(t(lowFP$x))
lowFP["D"] <- "S"  
lowFP$D[(which(lowFP[5]==max(lowFP[5]))+1):nrow(lowFP)] <- "U"

# Fig labs
colnames(lowFP) <- c("Rs","Cj","Ca","P","fP","D")

lowFP_filt <- 
  lowFP %>% 
  filter(P > 0)

your.number.low <-round(tail(lowFP_filt$fP,n=1),digits=3)
target.index.low <- which(abs(lowFP_filt$fP - your.number.low) == min(abs(lowFP_filt$fP - your.number.low)))

lowFP_filt$D[(target.index.low-1):which(lowFP_filt[5]==max(lowFP_filt[5]))+1] <- "dot"

lowFP$D <- factor(as.factor(lowFP$D), levels = c(levels(as.factor(lowFP$D))))

# 294.15K
medFP <- readMat("294K_FP_NAN_mp.mat")

medFP <- as.data.frame(t(medFP$x))
medFP["D"] <- "S"
medFP$D[(which(medFP[5]==max(medFP[5]))+1):nrow(medFP)] <- "U"

# Fig labs
colnames(medFP) <- c("Rs","Cj","Ca","P","fP","D")

medFP_filt <- 
  medFP %>% 
  filter(P > 0)

your.number.med <-round(tail(medFP_filt$fP,n=1),digits=4)
target.index.med <- which(abs(medFP_filt$fP - your.number.med) == min(abs(medFP_filt$fP - your.number.med)))

target.index.med <- ifelse(target.index.med==nrow(medFP_filt),
                           yes = 0,
                           no = target.index.med)

medFP_filt$D[target.index.med:which(medFP_filt[5]==max(medFP_filt[5]))+1] <- "dot"

#297.15K
highFP <- readMat("297K_FP_NAN_mp.mat")

highFP <- as.data.frame(t(highFP$x))
highFP["D"] <- "S"
highFP$D[(which(highFP[5]==max(highFP[5]))+1):nrow(highFP)] <- "U"

# Fig labs
colnames(highFP) <- c("Rs","Cj","Ca","P","fP","D")

highFP_filt <- 
  highFP %>% 
  filter(P > 0)

your.number.high <-round(tail(highFP_filt$fP,n=1),digits=3)
target.index.high <- which(abs(highFP_filt$fP - your.number.high) == min(abs(highFP_filt$fP - your.number.high)))

target.index.high <- ifelse(target.index.high==nrow(highFP_filt),
                           yes = 0,
                           no = target.index.high)

highFP_filt$D[target.index.high:which(highFP_filt[5]==max(highFP_filt[5]))+1] <- "dot"
```


```{r}
pdf("Fig2.pdf", width = 12, height = 6, useDingbats=FALSE, pointsize = 12)
par(mfrow=c(2,4), mar=c(3.1,2.1,2.5,2), omi=c(0.4,0.4,0.2,0.4))

plot(highFP_filt$fP[highFP_filt$D=="S"],highFP_filt$Rs[highFP_filt$D=="S"],
     ylab="",
     xlab="",
    xlim=c(0,0.03),
     type="l",
     ylim=c(0,9),
     lwd=2,
    xaxt="n",
    yaxt="n")

axis(side= 1, at = c(0,0.01,0.02,0.03),cex.axis=1.6)
rug(x = c(0,0.005,0.015,0.025), ticksize = -0.025, side = 1)

axis(side=2, at = c(0,2,4,6,8), cex.axis=1.6)

mtext(expression(paste("Resource")), side=3, outer=F, line=1, adj=0.5, cex=1.20)
mtext(expression(paste(bold("(a)"))), side=1, outer=F, line=-16.5, adj=0, cex=0.9)

points(highFP_filt$fP[highFP_filt$D=="dot"],highFP_filt$Rs[highFP_filt$D=="dot"],
      type="l",
       lty=2,
      lwd=2)

points(highFP_filt$fP[highFP_filt$D=="U"],highFP_filt$Rs[highFP_filt$D=="U"],
      xlim=c(0,0.025),
     type="l",
     col="red")

segments(tail(highFP_filt$fP), tail(highFP_filt$Rs), x1=1,y1=tail(highFP_filt$Rs),lwd=2)

plot(medFP_filt$fP[highFP_filt$D=="S"],highFP_filt$Cj[highFP_filt$D=="S"],
     ylab="",
     xlab="",
    xlim=c(0,0.03),
     type="l",
     ylim=c(0.5,2),
     lwd=2,
    xaxt="n",
    yaxt="n")

axis(side= 1, at = c(0,0.01,0.02,0.03),cex.axis=1.6)
rug(x = c(0,0.005,0.015,0.025), ticksize = -0.025, side = 1)

axis(side=2, at = c(0.5,1,1.5,2), cex.axis=1.6)

mtext(expression(paste("Juvenile Consumer")), side=3, outer=F, line=1, adj=0.5, cex=1.2)
mtext(expression(paste(bold("(b)"))), side=1, outer=F, line=-16.5, adj=0, cex=0.9)

points(highFP_filt$fP[highFP_filt$D=="dot"],highFP_filt$Cj[highFP_filt$D=="dot"],
      type="l",
       lty=2,
      lwd=2)

points(highFP_filt$fP[highFP_filt$D=="U"],highFP_filt$Cj[highFP_filt$D=="U"],
      xlim=c(0,0.03),
     type="l",
     col="red")

segments(tail(highFP_filt$fP,n=1), tail(highFP_filt$Cj,n=1), x1=1,y1=tail(highFP_filt$Cj,n=1),lwd=2)

plot(highFP_filt$fP[highFP_filt$D=="S"],highFP_filt$Ca[highFP_filt$D=="S"],
     ylab="",
     xlab="",
     ylim=c(0,6.5),
     xlim=c(0,0.03),
     type="l",
     lwd=2,
     xaxt="n",
    yaxt="n")

axis(side= 1, at = c(0,0.01,0.02,0.03),cex.axis=1.6)
rug(x = c(0,0.005,0.015,0.025), ticksize = -0.025, side = 1)

axis(side=2, at = c(0,2,4,6), cex.axis=1.6)

mtext(expression(paste("Adult Consumer")), side=3, outer=F, line=1, adj=0.5, cex=1.2)
mtext(expression(paste(bold("(c)"))), side=1, outer=F, line=-16.5, adj=0, cex=0.9)

points(highFP_filt$fP[highFP_filt$D=="dot"],highFP_filt$Ca[highFP_filt$D=="dot"],
      type="l",
       lty=2,
      lwd=2)

points(highFP_filt$fP[highFP_filt$D=="U"],highFP_filt$Ca[highFP_filt$D=="U"],
     type="l",
     col="red")

segments(tail(highFP_filt$fP,n=1), tail(highFP_filt$Ca,n=1), x1=1,y1=tail(highFP_filt$Ca,n=1),lwd=2)

plot(highFP_filt$fP[highFP_filt$D=="S"],highFP_filt$P[highFP_filt$D=="S"],
     ylab="",
     xlab="",
    xlim=c(0,0.03),
     type="l",
     ylim=c(0,5),
     lwd=2,
    xaxt="n",
    yaxt="n")

axis(side= 1, at = c(0,0.01,0.02,0.03),cex.axis=1.6)
rug(x = c(0,0.005,0.015,0.025), ticksize = -0.025, side = 1)

axis(side=2, at = c(0,1,2,3,4,5), cex.axis=1.6)

mtext(expression(paste("Predator")), side=3, outer=F, line=1, adj=0.5, cex=1.2)
mtext(expression(paste(bold("(d)"))), side=1, outer=F, line=-16.5, adj=0, cex=0.9)

points(highFP_filt$fP[highFP_filt$D=="dot"],highFP_filt$P[highFP_filt$D=="dot"],
      type="l",
       lty=2,
      lwd=2)

points(highFP_filt$fP[highFP_filt$D=="U"],highFP_filt$P[highFP_filt$D=="U"],
     type="l",
     col="red")

segments(tail(highFP_filt$fP,n=1), tail(highFP_filt$P,n=1), x1=1,y1=tail(highFP_filt$P,n=1),lwd=2)

#par(mar=c(7.5,4.6,0.1,2))

plot(lowFP_filt$fP[lowFP_filt$D=="S"],lowFP_filt$Rs[lowFP_filt$D=="S"],
     ylab="",
     xlab="",
    xlim=c(0,0.03),
     type="l",
     ylim=c(0,9),
     lwd=2,
    xaxt="n",
    yaxt="n")

axis(side= 1, at = c(0,0.01,0.02,0.03),cex.axis=1.6)
rug(x = c(0,0.005,0.015,0.025), ticksize = -0.025, side = 1)

axis(side=2, at = c(0,2,4,6,8), cex.axis=1.6)

mtext(expression(paste(bold("(e)"))), side=1, outer=F, line=-16.5, adj=0, cex=0.9)

points(lowFP_filt$fP[lowFP_filt$D=="dot"],lowFP_filt$Rs[lowFP_filt$D=="dot"],
      type="l",
       lty=2,
      lwd=2)

points(lowFP_filt$fP[lowFP_filt$D=="U"],lowFP_filt$Rs[lowFP_filt$D=="U"],
      xlim=c(0,0.03),
     type="l",
     col="red")

segments(tail(lowFP_filt$fP), tail(lowFP_filt$Rs), x1=1,y1=tail(lowFP_filt$Rs),lwd=2)

plot(lowFP_filt$fP[lowFP_filt$D=="S"],lowFP_filt$Cj[lowFP_filt$D=="S"],
     ylab="",
     xlab="",
    xlim=c(0,0.03),
     type="l",
     ylim=c(0.5,2),
     lwd=2,
    xaxt="n",
    yaxt="n")

axis(side= 1, at = c(0,0.01,0.02,0.03),cex.axis=1.6)
rug(x = c(0,0.005,0.015,0.025), ticksize = -0.025, side = 1)

axis(side=2, at = c(0.5,1,1.5,2), cex.axis=1.6)

mtext(expression(paste(bold("(f)"))), side=1, outer=F, line=-16.5, adj=0, cex=0.9)

points(lowFP_filt$fP[lowFP_filt$D=="dot"],lowFP_filt$Cj[lowFP_filt$D=="dot"],
      type="l",
       lty=2,
      lwd=2)

points(lowFP_filt$fP[lowFP_filt$D=="U"],lowFP_filt$Cj[lowFP_filt$D=="U"],
      xlim=c(0,0.03),
     type="l",
     col="red")

segments(tail(lowFP_filt$fP,n=1), tail(lowFP_filt$Cj,n=1), x1=1,y1=tail(lowFP_filt$Cj,n=1),lwd=2)

plot(lowFP_filt$fP[lowFP_filt$D=="S"],lowFP_filt$Ca[lowFP_filt$D=="S"],
     ylab="",
     xlab="",
     ylim=c(0,6.5),
     xlim=c(0,0.03),
     type="l",
     lwd=2,
     xaxt="n",
    yaxt="n")

axis(side= 1, at = c(0,0.01,0.02,0.03),cex.axis=1.6)
rug(x = c(0,0.005,0.015,0.025), ticksize = -0.025, side = 1)

axis(side=2, at = c(0,2,4,6,8), cex.axis=1.6)

mtext(expression(paste(bold("(g)"))), side=1, outer=F, line=-16.5, adj=0, cex=0.9)

points(lowFP_filt$fP[lowFP_filt$D=="dot"],lowFP_filt$Ca[lowFP_filt$D=="dot"],
      type="l",
       lty=2,
      lwd=2)

points(lowFP_filt$fP[lowFP_filt$D=="U"],lowFP_filt$Ca[lowFP_filt$D=="U"],
     type="l",
     col="red")

segments(tail(lowFP_filt$fP,n=1), tail(lowFP_filt$Ca,n=1), x1=1,y1=tail(lowFP_filt$Ca,n=1),lwd=2)

plot(lowFP_filt$fP[lowFP_filt$D=="S"],lowFP_filt$P[lowFP_filt$D=="S"],
     ylab="",
     xlab="",
    xlim=c(0,0.03),
     type="l",
     ylim=c(0,5),
     lwd=2,
    xaxt="n",
    yaxt="n")

axis(side= 1, at = c(0,0.01,0.02,0.03),cex.axis=1.6)
rug(x = c(0,0.005,0.015,0.025), ticksize = -0.025, side = 1)

axis(side=2, at = c(0,1,2,3,4,5), cex.axis=1.6)

mtext(expression(paste(bold("(h)"))), side=1, outer=F, line=-16.5, adj=0, cex=0.9)

points(lowFP_filt$fP[lowFP_filt$D=="dot"],lowFP_filt$P[lowFP_filt$D=="dot"],
      type="l",
       lty=2,
      lwd=2)

points(lowFP_filt$fP[lowFP_filt$D=="U"],lowFP_filt$P[lowFP_filt$D=="U"],
     type="l",
     col="red")

segments(tail(lowFP_filt$fP,n=1), tail(lowFP_filt$P,n=1), x1=1,y1=tail(lowFP_filt$P,n=1),lwd=2)

mtext(expression(paste("Equilibrium biomass density ", "[", g ~m^{-3}, "]")), las=3, side=2, outer=T, line=0.8, adj=0.5, cex=1.25)

mtext(text=expression(paste("Fishing pressure on predators (", ~f[P], ")")), side=1, outer=T, line=1.2, adj=0.5, las=1, cex=1.25)

mtext(expression(paste(  italic(24*degree ), "C", )), side=4, outer=T, line=0.6, adj=0.75, cex=1.25, las=0)
mtext(expression(paste(  italic(18*degree ), "C", )), side=4, outer=T, line=0.6, adj=0.25, cex=1.25, las=0)
```

### Figure 3: Maturation rate and reproduction rate at $18^\circ C$ and $24^\circ C$ (filename: Fig3.png)
```{r}
#291.15K
lowUF_FP <- readMat("291K_FP_NAN_mp.mat")

lowUF_FP <- as.data.frame(t(lowUF_FP$h))

lowUF_FP <- lowUF_FP[-c(1:4,7,9,15,16,17)]

colnames(lowUF_FP) <- c("mr","rj","mj","ma","nj","na","np","rp")

lowUF_FP <- cbind(lowFP_filt[-c(1:4,6)],lowUF_FP[1:112,1:8])

#297.15K
highUF_FP <- readMat("297K_FP_NAN_mp.mat")

highUF_FP <- as.data.frame(t(highUF_FP$h))

highUF_FP <- highUF_FP[-c(1:4,7,9,15,16,17)]

colnames(highUF_FP) <- c("mr","rj","mj","ma","nj","na","np","rp")

highUF_FP <- cbind(highFP_filt[-c(1:4,6)],highUF_FP[1:50,1:8])

lowUF_FP["D"] <- "S" 

lowUF_FP$D[(which(lowUF_FP[1]==max(lowUF_FP[1]))+1):nrow(lowUF_FP)] <- "U"

your.number.low <-round(tail(lowUF_FP$fP,n=1),digits=3)
target.index.low <- which(abs(lowUF_FP$fP - your.number.low) == min(abs(lowUF_FP$fP - your.number.low)))

lowUF_FP$D[(target.index.low-1):which(lowUF_FP[1]==max(lowUF_FP[1]))+1] <- "dot"

highUF_FP["D"] <- "S" 

highUF_FP$D[(which(highUF_FP[1]==max(highUF_FP[1]))+1):nrow(highUF_FP)] <- "U"
```



```{r}
par(mfrow=c(1,2))
plot(lowUF_FP$fP[lowUF_FP$D=="S"],lowUF_FP$mr[lowUF_FP$D=="S"],
     type="l",
     ylim=c(0,0.16),
     xlim=c(0,0.03),
     col="black",
     lwd=5,
     xlab="",
     ylab="",
     main=expression(paste(  italic(18*degree ), "C", )))

mtext(expression(paste(bold("(a)"))), side=1, outer=F, line=-16.5, adj=0, cex=0.9)

legend(x= "topright", y=0.7,
       legend = c("Maturation rate","Reproduction rate"),
       col = c("Black","Gray"),
       lty=1,
       lwd=5,
       bty="n")

points(lowUF_FP$fP[lowUF_FP$D=="dot"],lowUF_FP$mr[lowUF_FP$D=="dot"],
       type="l",
       lwd=5,
       lty="22")

points(lowUF_FP$fP[lowUF_FP$D=="U"],lowUF_FP$mr[lowUF_FP$D=="U"],
       type="l",
       lwd=1)

mtext(expression(paste("Biomass x", ~Time^{-1}, "")), las=3, side=2, outer=F, line=2, adj=0.5, cex=1.25)

points(lowUF_FP$fP[lowUF_FP$D=="S"],lowUF_FP$rj[lowUF_FP$D=="S"],
       type="l",
       col="gray",
       lwd=5)

points(lowUF_FP$fP[lowUF_FP$D=="dot"],lowUF_FP$rj[lowUF_FP$D=="dot"],
       type="l",
       lwd=5,
       col="gray",
       lty="22")

points(lowUF_FP$fP[lowUF_FP$D=="U"],lowUF_FP$rj[lowUF_FP$D=="U"],
       type="l",
       col="gray",
       lwd=1)

segments(tail(lowUF_FP$fP,n=1), tail(lowUF_FP$mr,n=1), x1=1,y1=tail(lowUF_FP$mr,n=1),lwd=5, col="black")
segments(tail(lowUF_FP$fP,n=1), tail(lowUF_FP$rj,n=1), x1=1,y1=tail(lowUF_FP$rj,n=1),lwd=5, col="gray")

plot(highUF_FP$fP[highUF_FP$D=="S"],highUF_FP$mr[highUF_FP$D=="S"],
     ylim=c(0,0.16),
     xlim=c(0,0.03),
     type="l",
     col="black",
     lwd=5,
     xlab="",
     ylab="",
     lty="22",
     main=expression(paste(  italic(24*degree ), "C", )))

mtext(expression(paste(bold("(b)"))), side=1, outer=F, line=-16.5, adj=0, cex=0.9)

points(highUF_FP$fP[highUF_FP$D=="U"],highUF_FP$mr[highUF_FP$D=="U"],
       type="l",
       lwd=1)

points(highUF_FP$fP[highUF_FP$D=="S"],highUF_FP$rj[highUF_FP$D=="S"],
       type="l",
       col="gray",
       lwd=5,
       lty="22")

points(highUF_FP$fP[highUF_FP$D=="U"],highUF_FP$rj[highUF_FP$D=="U"],
       type="l",
       col="gray",
       lwd=1)

segments(tail(highUF_FP$fP,n=1), tail(highUF_FP$mr,n=1), x1=1,y1=tail(highUF_FP$mr,n=1),lwd=5, col="black")
segments(tail(highUF_FP$fP,n=1), tail(highUF_FP$rj,n=1), x1=1,y1=tail(highUF_FP$rj,n=1),lwd=5, col="gray")

mtext(text=expression(paste("Fishing pressure on predators (", ~f[P], ")")), 
      side=1, outer=T, line=-1.5, adj=0.5, las=1, cex=1.25)
```

### Figure 4: Fishing on adult consumers at $18^\circ C$ and $24^\circ C$ (filename: Fig4.pdf)

```{r}
hopf.start <- 0.0491931
hopf.stop <- 0.45588837

lowFA <- readMat("291K_FA.mat")
lowFA <- as.data.frame(t(lowFA$x))
lowFA["D"] <- "S1"
lowFA$D[which(lowFA[5]>=hopf.start):which(lowFA[5]>=hopf.stop)] <- "U"
lowFA$D[which(lowFA[5]>=hopf.stop):nrow(lowFA)] <- "S2"
colnames(lowFA) <- c("Rs","Cj","Ca","P","fA","D")

medFA <- readMat("294K_FA.mat")
medFA <- as.data.frame(t(medFA$x))
colnames(medFA) <- c("Rs","Cj","Ca","P","fA")

highFA <- readMat("297K_FA.mat")
highFA <- as.data.frame(t(highFA$x))
colnames(highFA) <- c("Rs","Cj","Ca","P","fA")

PCRcyclic0.05  <- readMat("FA_cyc_0.05.mat")
time0.05 <- PCRcyclic0.05$t[,1]
PCRcyclic0.05 <- as.data.frame(cbind(PCRcyclic0.05$y[,1:4]))
PCRcyclic0.05[,5] <-time0.05
PCRcyclic0.05 <- as.data.frame(PCRcyclic0.05[which(PCRcyclic0.05[,5] >= 990000), ])
PCRcyclic0.05 <- cbind(rbind(apply(PCRcyclic0.05[,1:4],2,min), apply(PCRcyclic0.05[,1:4],2,max)), c(0.05,0.05),c("min","max"))
colnames(PCRcyclic0.05) <- c("Rs","Cj","Ca","P","Fishing pressure","minmax")

PCRcyclic0.075  <- readMat("FA_cyc_0.075.mat")
time0.075 <- PCRcyclic0.075$t[,1]
PCRcyclic0.075 <- as.data.frame(cbind(PCRcyclic0.075$y[,1:4]))
PCRcyclic0.075[,5] <-time0.075
PCRcyclic0.075 <- as.data.frame(PCRcyclic0.075[which(PCRcyclic0.075[,5] >= 990000), ])
PCRcyclic0.075 <- cbind(rbind(apply(PCRcyclic0.075[,1:4],2,min), apply(PCRcyclic0.075[,1:4],2,max)), c(0.075,0.075),c("min","max"))
colnames(PCRcyclic0.075) <- c("Rs","Cj","Ca","P","Fishing pressure","minmax")

PCRcyclic0.1  <- readMat("FA_cyc_0.1.mat")
time0.1 <- PCRcyclic0.1$t[,1]
PCRcyclic0.1 <- as.data.frame(cbind(PCRcyclic0.1$y[,1:4]))
PCRcyclic0.1[,5] <-time0.1
PCRcyclic0.1 <- as.data.frame(PCRcyclic0.1[which(PCRcyclic0.1[,5] >= 990000), ])
PCRcyclic0.1 <- cbind(rbind(apply(PCRcyclic0.1[,1:4],2,min), apply(PCRcyclic0.1[,1:4],2,max)), c(0.1,0.1),c("min","max"))
colnames(PCRcyclic0.1) <- c("Rs","Cj","Ca","P","Fishing pressure","minmax")

PCRcyclic0.125  <- readMat("FA_cyc_0.125.mat")
time0.125 <- PCRcyclic0.125$t[,1]
PCRcyclic0.125 <- as.data.frame(cbind(PCRcyclic0.125$y[,1:4]))
PCRcyclic0.125[,5] <-time0.125
PCRcyclic0.125 <- as.data.frame(PCRcyclic0.125[which(PCRcyclic0.125[,5] >= 990000), ])
PCRcyclic0.125 <- cbind(rbind(apply(PCRcyclic0.125[,1:4],2,min), apply(PCRcyclic0.125[,1:4],2,max)), c(0.125,0.125),c("min","max"))
colnames(PCRcyclic0.125) <- c("Rs","Cj","Ca","P","Fishing pressure","minmax")

PCRcyclic0.15  <- readMat("FA_cyc_0.15.mat")
time0.15 <- PCRcyclic0.15$t[,1]
PCRcyclic0.15 <- as.data.frame(cbind(PCRcyclic0.15$y[,1:4]))
PCRcyclic0.15[,5] <-time0.15
PCRcyclic0.15 <- as.data.frame(PCRcyclic0.15[which(PCRcyclic0.15[,5] >= 990000), ])
PCRcyclic0.15 <- cbind(rbind(apply(PCRcyclic0.15[,1:4],2,min), apply(PCRcyclic0.15[,1:4],2,max)), c(0.15,0.15),c("min","max"))
colnames(PCRcyclic0.15) <- c("Rs","Cj","Ca","P","Fishing pressure","minmax")

PCRcyclic0.175  <- readMat("FA_cyc_0.175.mat")
time0.175 <- PCRcyclic0.175$t[,1]
PCRcyclic0.175 <- as.data.frame(cbind(PCRcyclic0.175$y[,1:4]))
PCRcyclic0.175[,5] <-time0.175
PCRcyclic0.175 <- as.data.frame(PCRcyclic0.175[which(PCRcyclic0.175[,5] >= 990000), ])
PCRcyclic0.175 <- cbind(rbind(apply(PCRcyclic0.175[,1:4],2,min), apply(PCRcyclic0.175[,1:4],2,max)), c(0.175,0.175),c("min","max"))
colnames(PCRcyclic0.175) <- c("Rs","Cj","Ca","P","Fishing pressure","minmax")

PCRcyclic0.2  <- readMat("FA_cyc_0.2.mat")
time0.2 <- PCRcyclic0.2$t[,1]
PCRcyclic0.2 <- as.data.frame(cbind(PCRcyclic0.2$y[,1:4]))
PCRcyclic0.2[,5] <-time0.2
PCRcyclic0.2 <- as.data.frame(PCRcyclic0.2[which(PCRcyclic0.2[,5] >= 990000), ])
PCRcyclic0.2 <- cbind(rbind(apply(PCRcyclic0.2[,1:4],2,min), apply(PCRcyclic0.2[,1:4],2,max)), c(0.2,0.2),c("min","max"))
colnames(PCRcyclic0.2) <- c("Rs","Cj","Ca","P","Fishing pressure","minmax")

PCRcyclic0.225  <- readMat("FA_cyc_0.225.mat")
time0.225 <- PCRcyclic0.225$t[,1]
PCRcyclic0.225 <- as.data.frame(cbind(PCRcyclic0.225$y[,1:4]))
PCRcyclic0.225[,5] <-time0.225
PCRcyclic0.225 <- as.data.frame(PCRcyclic0.225[which(PCRcyclic0.225[,5] >= 990000), ])
PCRcyclic0.225 <- cbind(rbind(apply(PCRcyclic0.225[,1:4],2,min), apply(PCRcyclic0.225[,1:4],2,max)), c(0.225,0.225),c("min","max"))
colnames(PCRcyclic0.225) <- c("Rs","Cj","Ca","P","Fishing pressure","minmax")

PCRcyclic0.25  <- readMat("FA_cyc_0.25.mat")
time0.25 <- PCRcyclic0.25$t[,1]
PCRcyclic0.25 <- as.data.frame(cbind(PCRcyclic0.25$y[,1:4]))
PCRcyclic0.25[,5] <-time0.25
PCRcyclic0.25 <- as.data.frame(PCRcyclic0.25[which(PCRcyclic0.25[,5] >= 990000), ])
PCRcyclic0.25 <- cbind(rbind(apply(PCRcyclic0.25[,1:4],2,min), apply(PCRcyclic0.25[,1:4],2,max)), c(0.25,0.25),c("min","max"))
colnames(PCRcyclic0.25) <- c("Rs","Cj","Ca","P","Fishing pressure","minmax")

PCRcyclic0.275  <- readMat("FA_cyc_0.275.mat")
time0.275 <- PCRcyclic0.275$t[,1]
PCRcyclic0.275 <- as.data.frame(cbind(PCRcyclic0.275$y[,1:4]))
PCRcyclic0.275[,5] <-time0.275
PCRcyclic0.275 <- as.data.frame(PCRcyclic0.275[which(PCRcyclic0.275[,5] >= 990000), ])
PCRcyclic0.275 <- cbind(rbind(apply(PCRcyclic0.275[,1:4],2,min), apply(PCRcyclic0.275[,1:4],2,max)), c(0.275,0.275),c("min","max"))
colnames(PCRcyclic0.275) <- c("Rs","Cj","Ca","P","Fishing pressure","minmax")

PCRcyclic0.3  <- readMat("FA_cyc_0.3.mat")
time0.3 <- PCRcyclic0.3$t[,1]
PCRcyclic0.3 <- as.data.frame(cbind(PCRcyclic0.3$y[,1:4]))
PCRcyclic0.3[,5] <-time0.3
PCRcyclic0.3 <- as.data.frame(PCRcyclic0.3[which(PCRcyclic0.3[,5] >= 990000), ])
PCRcyclic0.3 <- cbind(rbind(apply(PCRcyclic0.3[,1:4],2,min), apply(PCRcyclic0.3[,1:4],2,max)), c(0.3,0.3),c("min","max"))
colnames(PCRcyclic0.3) <- c("Rs","Cj","Ca","P","Fishing pressure","minmax")

PCRcyclic0.325  <- readMat("FA_cyc_0.325.mat")
time0.325 <- PCRcyclic0.325$t[,1]
PCRcyclic0.325 <- as.data.frame(cbind(PCRcyclic0.325$y[,1:4]))
PCRcyclic0.325[,5] <-time0.325
PCRcyclic0.325 <- as.data.frame(PCRcyclic0.325[which(PCRcyclic0.325[,5] >= 990000), ])
PCRcyclic0.325 <- cbind(rbind(apply(PCRcyclic0.325[,1:4],2,min), apply(PCRcyclic0.325[,1:4],2,max)), c(0.325,0.325),c("min","max"))
colnames(PCRcyclic0.325) <- c("Rs","Cj","Ca","P","Fishing pressure","minmax")

PCRcyclic0.35  <- readMat("FA_cyc_0.35.mat")
time0.35 <- PCRcyclic0.35$t[,1]
PCRcyclic0.35 <- as.data.frame(cbind(PCRcyclic0.35$y[,1:4]))
PCRcyclic0.35[,5] <-time0.35
PCRcyclic0.35 <- as.data.frame(PCRcyclic0.35[which(PCRcyclic0.35[,5] >= 990000), ])
PCRcyclic0.35 <- cbind(rbind(apply(PCRcyclic0.35[,1:4],2,min), apply(PCRcyclic0.35[,1:4],2,max)), c(0.35,0.35),c("min","max"))
colnames(PCRcyclic0.35) <- c("Rs","Cj","Ca","P","Fishing pressure","minmax")

PCRcyclic0.375  <- readMat("FA_cyc_0.375.mat")
time0.375 <- PCRcyclic0.375$t[,1]
PCRcyclic0.375 <- as.data.frame(cbind(PCRcyclic0.375$y[,1:4]))
PCRcyclic0.375[,5] <-time0.375
PCRcyclic0.375 <- as.data.frame(PCRcyclic0.375[which(PCRcyclic0.375[,5] >= 990000), ])
PCRcyclic0.375 <- cbind(rbind(apply(PCRcyclic0.375[,1:4],2,min), apply(PCRcyclic0.375[,1:4],2,max)), c(0.375,0.375),c("min","max"))
colnames(PCRcyclic0.375) <- c("Rs","Cj","Ca","P","Fishing pressure","minmax")

PCRcyclic0.4  <- readMat("FA_cyc_0.4.mat")
time0.4 <- PCRcyclic0.4$t[,1]
PCRcyclic0.4 <- as.data.frame(cbind(PCRcyclic0.4$y[,1:4]))
PCRcyclic0.4[,5] <-time0.4
PCRcyclic0.4 <- as.data.frame(PCRcyclic0.4[which(PCRcyclic0.4[,5] >= 990000), ])
PCRcyclic0.4 <- cbind(rbind(apply(PCRcyclic0.4[,1:4],2,min), apply(PCRcyclic0.4[,1:4],2,max)), c(0.4,0.4),c("min","max"))
colnames(PCRcyclic0.4) <- c("Rs","Cj","Ca","P","Fishing pressure","minmax")

PCRcyclic0.425  <- readMat("FA_cyc_0.425.mat")
time0.425 <- PCRcyclic0.425$t[,1]
PCRcyclic0.425 <- as.data.frame(cbind(PCRcyclic0.425$y[,1:4]))
PCRcyclic0.425[,5] <-time0.425
PCRcyclic0.425 <- as.data.frame(PCRcyclic0.425[which(PCRcyclic0.425[,5] >= 990000), ])
PCRcyclic0.425 <- cbind(rbind(apply(PCRcyclic0.425[,1:4],2,min), apply(PCRcyclic0.425[,1:4],2,max)), c(0.425,0.425),c("min","max"))
colnames(PCRcyclic0.425) <- c("Rs","Cj","Ca","P","Fishing pressure","minmax")

PCRcyclic0.45  <- readMat("FA_cyc_0.45.mat")
time0.45 <- PCRcyclic0.45$t[,1]
PCRcyclic0.45 <- as.data.frame(cbind(PCRcyclic0.45$y[,1:4]))
PCRcyclic0.45[,5] <-time0.45
PCRcyclic0.45 <- as.data.frame(PCRcyclic0.45[which(PCRcyclic0.45[,5] >= 990000), ])
PCRcyclic0.45 <- cbind(rbind(apply(PCRcyclic0.45[,1:4],2,min), apply(PCRcyclic0.45[,1:4],2,max)), c(0.45,0.45),c("min","max"))
colnames(PCRcyclic0.45) <- c("Rs","Cj","Ca","P","Fishing pressure","minmax")

PCRcyclic <- as.data.frame(rbind(PCRcyclic0.05,PCRcyclic0.075,PCRcyclic0.1,PCRcyclic0.125,PCRcyclic0.15,PCRcyclic0.175,
                                 PCRcyclic0.2,PCRcyclic0.225,PCRcyclic0.25,PCRcyclic0.275,PCRcyclic0.3,PCRcyclic0.325,
                                 PCRcyclic0.35,PCRcyclic0.375,PCRcyclic0.4,PCRcyclic0.425,PCRcyclic0.45))

PCRcyclic["D"] <- "Cyc"

PCRcyclic$Ca <-  as.numeric(PCRcyclic$Ca)

PCRcyclic$`Fishing pressure` <-  as.numeric(PCRcyclic$`Fishing pressure`)

PCRcyclic["Yield"] <- PCRcyclic$Ca*PCRcyclic$`Fishing pressure`
```

```{r}
pdf("Fig4.pdf", width = 12, height = 6, useDingbats=FALSE)
par(mfrow=c(2,4), mar=c(3.1,2.1,2.5,2), omi=c(0.4,0.4,0.2,0.4))

plot(highFA$fA,highFA$Rs,
     ylab="",
     xlab="",
     ylim=c(3,15),
     xlim=c(0,1),
     type="l",
     lwd=2,
     xaxt="n",
     yaxt="n")

axis(side=1,at=c(0,0.25,0.5,0.75,1), cex.axis=1.6)

axis(side=2, at=c(3,6,9,12,15), cex.axis=1.6)

mtext(expression(paste("Resource")), side=3, outer=F, line=1, adj=0.5, cex=1.2)
mtext(expression(paste(bold("(a)"))), side=1, outer=F, line=-16.5, adj=0, cex=0.9)

plot(highFA$fA,highFA$Cj,
     ylab="",
     xlab="",
     ylim=c(0.4,2),
     xlim=c(0,1),
     type="l",
     lwd=2,
     xaxt="n",
     yaxt="n")

axis(side=1,at=c(0,0.25,0.5,0.75,1), cex.axis=1.6)

axis(side=2, at=c(0,0.4,0.8,1.2,1.6,2), cex.axis=1.6)

mtext(expression(paste("Juvenile Consumer")), side=3, outer=F, line=1, adj=0.5, cex=1.2)
mtext(expression(paste(bold("(b)"))), side=1, outer=F, line=-16.5, adj=0, cex=0.9)

plot(highFA$fA,highFA$Ca,
     ylab="",
     xlab="",
     ylim=c(0,1.5),
     xlim=c(0,1),
     type="l",
     lwd=2,
     xaxt="n",
     yaxt="n")

axis(side=1,at=c(0,0.25,0.5,0.75,1), cex.axis=1.6)

axis(side=2, at=c(0,0.5,1,1.5), cex.axis=1.6)

mtext(expression(paste("Adult Consumer")), side=3, outer=F, line=1, adj=0.5, cex=1.2)
mtext(expression(paste(bold("(c)"))), side=1, outer=F, line=-16.5, adj=0, cex=0.9)

plot(highFA$fA,highFA$P,
     ylab="",
     xlab="",
     ylim=c(0.5,4.5),
     xlim=c(0,1),
     type="l",
     lwd=2,
     xaxt="n",
     yaxt="n")

axis(side=1,at=c(0,0.25,0.5,0.75,1), cex.axis=1.6)

axis(side=2, at=c(1,2,3,4), cex.axis=1.6)

mtext(expression(paste("Predator")), side=3, outer=F, line=1, adj=0.5, cex=1.2)
mtext(expression(paste(bold("(d)"))), side=1, outer=F, line=-16.5, adj=0, cex=0.9)

plot(PCRcyclic$`Fishing pressure`[PCRcyclic$minmax=="min"],PCRcyclic$Rs[PCRcyclic$minmax=="min"],
     ylim=c(3,15),
     xlim=c(0,1),
     pch=16,
     cex=0.75,
     xaxt="n",
     yaxt="n")

axis(side=1,at=c(0,0.25,0.5,0.75,1), cex.axis=1.6)

axis(side=2, at=c(3,6,9,12,15), cex.axis=1.6)

mtext(expression(paste(bold("(e)"))), side=1, outer=F, line=-16.5, adj=0, cex=0.9)

points(PCRcyclic$`Fishing pressure`[PCRcyclic$minmax=="max"],PCRcyclic$Rs[PCRcyclic$minmax=="max"],
       pch=16,
     cex=0.75)

points(lowFA$fA[lowFA$D=="S1"],lowFA$Rs[lowFA$D=="S1"], 
       type="l",
       lwd=2)

points(lowFA$fA[lowFA$D=="S2"],lowFA$Rs[lowFA$D=="S2"], 
       type="l",
       lwd=2)

plot(PCRcyclic$`Fishing pressure`[PCRcyclic$minmax=="min"],PCRcyclic$Cj[PCRcyclic$minmax=="min"],
     ylim=c(0.4,2),
     xlim=c(0,1),
     pch=16,
     cex=0.75,
     xaxt="n",
     yaxt="n")

axis(side=1,at=c(0,0.25,0.5,0.75,1), cex.axis=1.6)

axis(side=2, at=c(0.4,0.8,1.2,1.6,2), cex.axis=1.6)

mtext(expression(paste(bold("(f)"))), side=1, outer=F, line=-16.5, adj=0, cex=0.9)

points(PCRcyclic$`Fishing pressure`[PCRcyclic$minmax=="max"],PCRcyclic$Cj[PCRcyclic$minmax=="max"],
       pch=16,
     cex=0.75)

points(lowFA$fA[lowFA$D=="S1"],lowFA$Cj[lowFA$D=="S1"], 
       type="l",
       lwd=2)

points(lowFA$fA[lowFA$D=="S2"],lowFA$Cj[lowFA$D=="S2"], 
       type="l",
       lwd=2)

plot(PCRcyclic$`Fishing pressure`[PCRcyclic$minmax=="min"],PCRcyclic$Ca[PCRcyclic$minmax=="min"],
     ylim=c(0,1.5),
     xlim=c(0,1),
     pch=16,
     cex=0.75,
     xaxt="n",
     yaxt="n")

axis(side=1,at=c(0,0.25,0.5,0.75,1), cex.axis=1.6)

axis(side=2, at=c(0,0.5,1,1.5), cex.axis=1.6)

mtext(expression(paste(bold("(g)"))), side=1, outer=F, line=-16.5, adj=0, cex=0.9)

points(PCRcyclic$`Fishing pressure`[PCRcyclic$minmax=="max"],PCRcyclic$Ca[PCRcyclic$minmax=="max"],
       pch=16,
     cex=0.75)

points(lowFA$fA[lowFA$D=="S1"],lowFA$Ca[lowFA$D=="S1"], 
       type="l",
       lwd=2)

points(lowFA$fA[lowFA$D=="S2"],lowFA$Ca[lowFA$D=="S2"], 
       type="l",
       lwd=2)

plot(PCRcyclic$`Fishing pressure`[PCRcyclic$minmax=="min"],PCRcyclic$P[PCRcyclic$minmax=="min"],
     ylim=c(0.5,4.5),
     xlim=c(0,1),
     pch=16,
     cex=0.75,
     xaxt="n",
     yaxt="n")

axis(side=1,at=c(0,0.25,0.5,0.75,1), cex.axis=1.6)

axis(side=2, at=c(1,2,3,4), cex.axis=1.6)

mtext(expression(paste(bold("(h)"))), side=1, outer=F, line=-16.5, adj=0, cex=0.9)

points(PCRcyclic$`Fishing pressure`[PCRcyclic$minmax=="max"],PCRcyclic$P[PCRcyclic$minmax=="max"],
       pch=16,
     cex=0.75)

points(lowFA$fA[lowFA$D=="S1"],lowFA$P[lowFA$D=="S1"],
       type="l",
       lwd=2)

points(lowFA$fA[lowFA$D=="S2"],lowFA$P[lowFA$D=="S2"], 
       type="l",
       lwd=2)

mtext(expression(paste("Equilibrium biomass density ", "[", g ~m^{-3}, "]")), las=3, side=2, outer=T, line=0.8, adj=0.5, cex=1.25)

mtext(text=expression(paste("Fishing pressure on adults (", ~f[A], ")")), side=1, outer=T, line=1.2, adj=0.5, las=1, cex=1.25)

mtext(expression(paste(  italic(24*degree ), "C", )), side=4, outer=T, line=0.6, adj=0.75, cex=1.25, las=0)
mtext(expression(paste(  italic(18*degree ), "C", )), side=4, outer=T, line=0.6, adj=0.25, cex=1.25, las=0)

```

### Figure 5: Yield (filename: Fig5.png)
```{r}
yieldlow <- data.frame(lowFP_filt$P*lowFP_filt$fP)

yieldlow <- cbind(yieldlow,lowFP_filt$fP)

colnames(yieldlow) <- c("Yield","fP")

yieldlow["D"] <- "S"
yieldlow$D[(which(yieldlow[2]==max(yieldlow[2]))+1):nrow(yieldlow)] <- "U"

yieldlow["D"] <- "S"
yieldlow$D[(which(yieldlow[2]==max(yieldlow[2]))+1):nrow(yieldlow)] <- "U"

your.number.low <-round(tail(yieldlow$fP,n=1),digits=3)
target.index.low <- which(abs(yieldlow$fP - your.number.low) == min(abs(yieldlow$fP - your.number.low)))

yieldlow$D[(target.index.low-1):which(yieldlow[2]==max(yieldlow[2]))+1] <- "dot"

yieldhigh <- data.frame(highFP_filt$P*highFP_filt$fP)

yieldhigh <- cbind(yieldhigh,highFP_filt$fP)

colnames(yieldhigh) <- c("Yield","fP")

yieldhigh["D"] <- "S"
yieldhigh$D[(which(yieldhigh[2]==max(yieldhigh[2]))+1):nrow(yieldhigh)] <- "U"


par(mfrow=c(1,2), cex=1, mar=c(5,1,2,1), oma=c(1,5,1,5))
plot(yieldlow$fP[yieldlow$D=="S"],yieldlow$Yield[yieldlow$D=="S"], 
     type="l",
     col="blue",
     ylim=c(0,0.2),
     xlim=c(0,0.03),
     ylab="Yield",
     xlab=expression(paste("Fishing pressure on predators (", ~f[P], ")")))

points(yieldlow$fP[yieldlow$D=="dot"],yieldlow$Yield[yieldlow$D=="dot"],
       type="l",
       col="blue",
       lty="22")

segments(5.958851e-03, 0.001, x1=1, y1=0.001, col="blue")

segments(0, 0, x1=1, y1=0, col="red")

mtext(expression(paste(bold("(a)"))), side=1, outer=F, line=-14.5, adj=0, cex=0.9)

points(1.886808e-02,5.008574e-02,
       col="blue",
       pch=18)


points(yieldhigh$fP[yieldhigh$D=="S"],yieldhigh$Yield[yieldhigh$D=="S"], 
     type="l",
     xlim=c(0,0.01),
     col="red",
     lty="22")

points(8.196254e-03,0.0132949160,
       col="red",
       pch=18)

yieldlow <- data.frame(lowFA$Ca*lowFA$fA)

yieldlow <- cbind(yieldlow,lowFA$fA)

colnames(yieldlow) <- c("Yield","fA")

hopf.start <- 0.0491931
hopf.stop <- 0.45588837

yieldlow["D"] <- "S1"
yieldlow$D[which(yieldlow[2]>=hopf.start):which(yieldlow[2]>=hopf.stop)+1] <- "U"
yieldlow$D[50:nrow(yieldlow)] <- "S2"

plot(yieldlow$fA[yieldlow$D=="S1"],yieldlow$Yield[yieldlow$D=="S1"], 
     type="l",
     ylim=c(0,0.2),
     xlim=c(0,1),
     col="blue",
     yaxt="n",
     ylab="",
     xlab=expression(paste("Fishing pressure on adults (", ~f[A], ")")))

points(yieldlow$fA[yieldlow$D=="S2"],yieldlow$Yield[yieldlow$D=="S2"],
       type="l",
       col="blue")

points(PCRcyclic$`Fishing pressure`[PCRcyclic$minmax=="min"],PCRcyclic$Yield[PCRcyclic$minmax=="min"],
       pch=16,
     cex=0.75,
     col="blue")

points(PCRcyclic$`Fishing pressure`[PCRcyclic$minmax=="max"],PCRcyclic$Yield[PCRcyclic$minmax=="max"],
       pch=16,
     cex=0.75,
     col="blue")

mtext(expression(paste(bold("(b)"))), side=1, outer=F, line=-14.5, adj=0, cex=0.9)

yieldhigh <- data.frame(highFA$Ca*highFA$fA)

yieldhigh <- cbind(yieldhigh,highFA$fA)

colnames(yieldhigh) <- c("Yield","fA")

points(yieldhigh$fA,yieldhigh$Yield, 
     type="l",
     col="red")

legend(x="topleft", legend=c("18 °C", "24 °C"), lty=1, col=c("blue","red"), bty="n")

mtext(expression(paste("Yield ", "[", g ~m^{-3} ~day^{-1}, "]")), las=3, side=2, outer=T, line=1.5, adj=0.6, cex=1)
```


```{r}
yieldlow <- data.frame(lowFA_NP$Ca*lowFA_NP$fA)

yieldlow <- cbind(yieldlow,lowFA_NP$fA)

colnames(yieldlow) <- c("Yield","fA")

hopf.start <- 0.0491931
hopf.stop <- 0.45588837

plot(yieldlow$fA,yieldlow$Yield, 
     type="l",
     xlim=c(0,1),
     col="blue",
     ylab="",
     xlab=expression(paste("Fishing pressure on adults (", ~f[A], ")")))

yieldhigh <- data.frame(highFA_NP$Ca*highFA_NP$fA)

yieldhigh <- cbind(yieldhigh,highFA_NP$fA)

colnames(yieldhigh) <- c("Yield","fA")

points(yieldhigh$fA,yieldhigh$Yield, 
     type="l",
     col="red")

legend(x="topleft", legend=c("18 °C", "24 °C"), lty=1, col=c("blue","red"), bty="n")

mtext(expression(paste("Yield ", "[", g ~m^{-3} ~day^{-1}, "]")), las=3, side=2, outer=T, line=1.5, adj=0.6, cex=1)
```

# Figure 6: Fishing on adult consumers and predators at $18 ^\circ C$ and $24 ^\circ C$ (filename: Fig6.pdf)

```{r}
BIF2_LP_291K  <- readMat("291K_2BIF_LP.mat")
BIF2_LP_291K <- as.data.frame(t(BIF2_LP_291K$x)) # the stable and unstable coexistence

colnames(BIF2_LP_291K) <- c("Rs","Cj","Ca","P","fA","fP")

BIF2_hopf_291K <- readMat("291K_2BIF_hopf.mat")
BIF2_hopf_291K <- as.data.frame(t(BIF2_hopf_291K$x)) # the stable and unstable coexistence

colnames(BIF2_hopf_291K) <- c("Rs","Cj","Ca","P","fA","fP")

BIF2_LP_294K  <- readMat("294K_2BIF_LP.mat")
BIF2_LP_294K <- as.data.frame(t(BIF2_LP_294K$x)) # the stable and unstable coexistence

colnames(BIF2_LP_294K) <- c("Rs","Cj","Ca","P","fA","fP")

BIF2_LP_297K  <- readMat("297K_2BIF_LP.mat")
BIF2_LP_297K <- as.data.frame(t(BIF2_LP_297K$x)) # the stable and unstable coexistence

colnames(BIF2_LP_297K) <- c("Rs","Cj","Ca","P","fA","fP")

#297K

BIF2_BP_297K_fP <- c(0.037537654,0.039513913,0.040818867,0.041703036,0.042306706,0.042980507,0.043220478,0.04302708,0.042570361,0.042383176) 

BIF2_BP_297K_fA <- c(0.2,0.25,0.3,0.35,0.4,0.5,0.6,0.8,0.95,1)

extinct297K <- data.frame(BIF2_BP_297K_fA,BIF2_BP_297K_fP)

colnames(extinct297K) <- c("fA","fP")

BIF2_LP_297K_filt <- 
  BIF2_LP_297K %>% 
  filter(P > 0)

BIF2_LP_297K_filt_fA_fP <- BIF2_LP_297K_filt[-c(1:4)]

BIF2_LP_297K <- rbind(BIF2_LP_297K_filt_fA_fP,extinct297K)

#291K

BIF2_BP_291K_fP <- c(0.042999276,0.044253699,0.044925518,0.045282786,0.045501325,0.045380611,0.045090779,0.044707454,0.044268926,0.043796382,0.043302308)

BIF2_BP_291K_fA <- c(0.15,0.2,0.25,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1)

extinct291K <- data.frame(BIF2_BP_291K_fA,BIF2_BP_291K_fP)

colnames(extinct291K) <- c("fA","fP")

BIF2_LP_291K_filt <- 
  BIF2_LP_291K %>% 
  filter(P > 0)

BIF2_LP_291K_filt_fA_fP <- BIF2_LP_291K_filt[-c(1:4)]

BIF2_LP_291K <- rbind(BIF2_LP_291K_filt_fA_fP,extinct291K)

#294K

BIF2_BP_294K_fP <- c(0.043035317,0.044273425,0.045033014,0.045775877,0.04597157,0.04588451,0.045635298,0.045286416,0.044873231,0.044417103)

BIF2_BP_294K_fA <- c(0.2,0.25,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1)

extinct294K <- data.frame(BIF2_BP_294K_fA,BIF2_BP_294K_fP)

colnames(extinct294K) <- c("fA","fP")

BIF2_LP_294K_filt <- 
  BIF2_LP_294K %>% 
  filter(P > 0)

BIF2_LP_294K_filt_fA_fP <- BIF2_LP_294K_filt[-c(1:4)]

BIF2_LP_294K <- rbind(BIF2_LP_294K_filt_fA_fP,extinct294K)
```


```{r}
pdf("Fig6.pdf", width = 9, height = 4, useDingbats=FALSE)
par(mfrow=c(1,2), xaxs="i", yaxs="i", pty="s", mar=c(3,0,2,0), oma=c(1.5,4,0.2,8.5))

plot(BIF2_LP_291K$fA,BIF2_LP_291K$fP,
     type="l",
     ylim=c(0,0.051),
     xlim=c(0,1),
     ylab="",
     xlab="",
     col="#e6550d")

rug(x = c(0.1,0.3,0.5,0.7,0.9), ticksize = -0.020, side = 1)
rug(x = c(0.005,0.015,0.025,0.035,0.045), ticksize = -0.020, side = 2)


mtext(expression(paste(bold("(a)"))), side=1, outer=F, line=-14.5, adj=0, cex=0.9)
mtext(expression(paste(  italic(18*degree ), "C", )), side=3, outer=F, line=0.6, adj=0.5, cex=1, las=1)


points(BIF2_hopf_291K$fA,BIF2_hopf_291K$fP,
       type="l",
       col="gray")

polygon(c(0,0.00625,0.0125,0.025,0.0375,0.05,0.0625,0.075,0.0875,0.1,0.105,0.126643672,0),c(tail(lowFP_filt$fP,n=1),0.014086206,0.019564098,0.026758913,0.031255539,0.03431658,0.036523328,0.038180681,0.039463964,0.040481145,0.040830088,0.04207169,1),col="#fdae6b",border=NA)

polygon(c(BIF2_hopf_291K$fA[BIF2_hopf_291K$fA>=0.05], max(BIF2_hopf_291K$fA), 0.05), c(BIF2_hopf_291K$fP[BIF2_hopf_291K$fA>=0.05], 0, 0), col="gray",border=NA)

polygon(c(BIF2_LP_291K$fA[BIF2_LP_291K$fA>=0], max(BIF2_LP_291K$fA), 0), c(BIF2_LP_291K$fP[BIF2_LP_291K$fA>=0], 1, 1), col="#e6550d",border=NA)

#297K

plot(BIF2_LP_297K$fA,BIF2_LP_297K$fP,
     type="l",
     ylim=c(0,0.051),
     xlim=c(0,1),
     ylab="",
     xlab="",
     col="#e6550d")

rug(x = c(0.1,0.3,0.5,0.7,0.9), ticksize = -0.020, side = 1)
rug(x = c(0.005,0.015,0.025,0.035,0.045), ticksize = -0.020, side = 2)

mtext(expression(paste(bold("(b)"))), side=1, outer=F, line=-14.5, adj=0, cex=0.9)

mtext(expression(paste(  italic(24*degree ), "C", )), side=3, outer=F, line=0.6, adj=0.5, cex=1, las=1)

polygon(c(0,0.0125,0.025,0.0375,0.05,0.075,0.1,0.125,0.15,0.175,2.128525e-01,0), c(tail(highFP_filt$fP,n=1),-0.0015294433,0.0070101484,0.013212024,0.017911029,0.024534667,0.028951195,0.03208082,0.034394903,0.036159869,0.038143871,1),
        col="#fdae6b",
        border=NA)

polygon(c(BIF2_LP_297K$fA[BIF2_LP_297K$fA>=0], max(BIF2_LP_297K$fA), 0), c(BIF2_LP_297K$fP[BIF2_LP_297K$fA>=0], 1, 1), col="#e6550d",border=NA)

mtext(text=expression(paste("Fishing pressure on adults (", ~f[A], ")")), side=1, outer=T, line=0, adj=0.5, las=1)

mtext(text=expression(paste("Fishing pressure on predators (", ~f[P], ")")), side=2, outer=T, line=2, adj=0.5, las=3)

par(xpd=NA)

legend(x="topright",
       inset=c(-0.75,0),
       title="Community composition",
       title.adj=0.5,
       title.col="gray",
       legend = c("C-R","Bistable: P-C-R/C-R","P-C-R","Cyclic P-C-R"), 
       fill = c("#e6550d","#fdae6b","white","gray"),
       bty="n")
```

#Figure S1: Intermediate temp fishing on predator (filename: FigS1.pdf)

```{r}
medFP <- readMat("294K_FP_NAN_mp.mat")

medFP <- as.data.frame(t(medFP$x)) 
medFP["D"] <- "S"
medFP$D[(which(medFP[5]==max(medFP[5]))+1):nrow(medFP)] <- "U"

# Fig labs
colnames(medFP) <- c("Rs","Cj","Ca","P","fP","D")

medFP_filt <- 
  medFP %>% 
  filter(P > 0)

your.number.med <-round(tail(medFP_filt$fP,n=1),digits=4)
target.index.med <- which(abs(medFP_filt$fP - your.number.med) == min(abs(medFP_filt$fP - your.number.med)))

target.index.med <- ifelse(target.index.med==nrow(medFP_filt),
                           yes = 0,
                           no = target.index.med)

medFP_filt$D[target.index.med:which(medFP_filt[5]==max(medFP_filt[5]))+1] <- "dot"
```

```{r}
pdf("FigS1.pdf", width = 12, height = 3.5, useDingbats=FALSE)
par(mfrow=c(1,4), mar=c(5.1,2.1,2.1,1.1),omi=c(0.2,0.4,0.2,0.5))

plot(medFP_filt$fP[medFP_filt$D=="S"],medFP_filt$Rs[medFP_filt$D=="S"],
     ylab="",
     xlab="",
    xlim=c(0,0.03),
     type="l",
     ylim=c(0,9),
     lwd=2,
    xaxt="n",
    yaxt="n")

axis(side= 1, at = c(0,0.01,0.02,0.03),cex.axis=1.6)
rug(x = c(0,0.005,0.015,0.025), ticksize = -0.025, side = 1)

axis(side=2, at = c(0,2,4,6,8), cex.axis=1.6)

mtext(expression(paste("Resource")), side=3, outer=F, line=1, adj=0.5, cex=1.2)

mtext(expression(paste(bold("(a)"))), side=1, outer=F, line=-18, adj=0, cex=0.9)

points(medFP_filt$fP[medFP_filt$D=="dot"],medFP_filt$Rs[medFP_filt$D=="dot"],
      type="l",
       lty=2,
      lwd=2)

points(medFP_filt$fP[medFP_filt$D=="U"],medFP_filt$Rs[medFP_filt$D=="U"],
      xlim=c(0,0.025),
     type="l",
     col="red")

segments(tail(medFP_filt$fP), tail(medFP_filt$Rs), x1=1,y1=tail(medFP_filt$Rs))

plot(medFP_filt$fP[medFP_filt$D=="S"],medFP_filt$Cj[medFP_filt$D=="S"],
     ylab="",
     xlab="",
    xlim=c(0,0.03),
     type="l",
     ylim=c(0.5,2),
     lwd=2,
    xaxt="n",
    yaxt="n")

axis(side= 1, at = c(0,0.01,0.02,0.03),cex.axis=1.6)
rug(x = c(0,0.005,0.015,0.025), ticksize = -0.025, side = 1)

axis(side=2, at = c(0.5,1,1.5,2), cex.axis=1.6)

mtext(expression(paste("Juvenile Consumer")), side=3, outer=F, line=1, adj=0.5, cex=1.2)

mtext(expression(paste(bold("(b)"))), side=1, outer=F, line=-18, adj=0, cex=0.9)

points(medFP_filt$fP[medFP_filt$D=="dot"],medFP_filt$Cj[medFP_filt$D=="dot"],
      type="l",
       lty=2,
      lwd=2)

points(medFP_filt$fP[medFP_filt$D=="U"],medFP_filt$Cj[medFP_filt$D=="U"],
      xlim=c(0,0.025),
     type="l",
     col="red")

segments(tail(medFP_filt$fP,n=1), tail(medFP_filt$Cj,n=1), x1=1,y1=tail(medFP_filt$Cj,n=1),lwd=2)

plot(medFP_filt$fP[medFP_filt$D=="S"],medFP_filt$Ca[medFP_filt$D=="S"],
     ylab="",
     xlab="",
     ylim=c(0,6.5),
     xlim=c(0,0.03),
     type="l",
     lwd=2,
    xaxt="n",
    yaxt="n")

axis(side= 1, at = c(0,0.01,0.02,0.03),cex.axis=1.6)
rug(x = c(0,0.005,0.015,0.025), ticksize = -0.025, side = 1)

axis(side=2, at = c(0,2,4,6), cex.axis=1.6)

mtext(expression(paste("Adult")), side=3, outer=F, line=1, adj=0.5, cex=1.2)

mtext(expression(paste(bold("(c)"))), side=1, outer=F, line=-18, adj=0, cex=0.9)

points(medFP_filt$fP[medFP_filt$D=="dot"],medFP_filt$Ca[medFP_filt$D=="dot"],
      type="l",
       lty=2,
      lwd=2)

points(medFP_filt$fP[medFP_filt$D=="U"],medFP_filt$Ca[medFP_filt$D=="U"],
     type="l",
     col="red")

segments(tail(medFP_filt$fP,n=1), tail(medFP_filt$Ca,n=1), x1=1,y1=tail(medFP_filt$Ca,n=1),lwd=2)

plot(medFP_filt$fP[medFP_filt$D=="S"],medFP_filt$P[medFP_filt$D=="S"],
     ylab="",
     xlab="",
    xlim=c(0,0.03),
     type="l",
     ylim=c(0,5),
     lwd=2,
    xaxt="n",
    yaxt="n")

axis(side= 1, at = c(0,0.01,0.02,0.03),cex.axis=1.6)
rug(x = c(0,0.005,0.015,0.025), ticksize = -0.025, side = 1)

axis(side=2, at = c(0,1,2,3,4,5), cex.axis=1.6)

mtext(expression(paste("Predator")), side=3, outer=F, line=1, adj=0.5, cex=1.2)

mtext(expression(paste(bold("(d)"))), side=1, outer=F, line=-18, adj=0, cex=0.9)

points(medFP_filt$fP[medFP_filt$D=="dot"],medFP_filt$P[medFP_filt$D=="dot"],
      type="l",
       lty=2,
      lwd=2)

points(medFP_filt$fP[medFP_filt$D=="U"],medFP_filt$P[medFP_filt$D=="U"],
     type="l",
     col="red")

segments(tail(medFP_filt$fP,n=1), tail(medFP_filt$P,n=1), x1=1,y1=tail(medFP_filt$P,n=1),lwd=2)

mtext(text=expression(paste("Fishing pressure on predators (", ~f[P], ")")), 
      side=1, outer=T, line=-1.5, adj=0.5, las=1, cex=1.25)

mtext(expression(paste("Equilibrium biomass density ", "[", g ~m^{-3}, "]")), las=3, side=2, outer=T, line=1, adj=0.5, cex=1.25)

mtext(expression(paste(  italic(21*degree ), "C", )), side=4, outer=T, line=0.6, adj=0.5, cex=1.25, las=0)
```


### Figure S2: Intermediate temp fishing on predator (filename: FigS2.pdf)

```{r}
pdf("FigS2.pdf", width = 12, height = 3.5, useDingbats=FALSE)
par(mfrow=c(1,4), mar=c(5.1,2.1,2.1,1.1),omi=c(0.2,0.4,0.2,0.5))

plot(medFA$fA,medFA$Rs,
     ylab="",
     xlab="",
     ylim=c(3,15),
     xlim=c(0,1),
     type="l",
     lwd=2,
     xaxt="n",
     yaxt="n")

axis(side=1,at=c(0,0.25,0.5,0.75,1), cex.axis=1.6)

axis(side=2, at=c(3,6,9,12,15), cex.axis=1.6)

mtext(expression(paste("Resource")), side=3, outer=F, line=1, adj=0.5, cex=1.2)
mtext(expression(paste(bold("(a)"))), side=1, outer=F, line=-18, adj=0, cex=0.9)

plot(medFA$fA,medFA$Cj,
     ylab="",
     xlab="",
     ylim=c(0.4,1.8),
     xlim=c(0,1),
     type="l",
     lwd=2,
     xaxt="n",
     yaxt="n")

axis(side=1,at=c(0,0.25,0.5,0.75,1), cex.axis=1.6)

axis(side=2, at=c(0.4,0.8,1.2,1.6,2), cex.axis=1.6)

mtext(expression(paste("Juvenile Consumer")), side=3, outer=F, line=1, adj=0.5, cex=1.2)
mtext(expression(paste(bold("(b)"))), side=1, outer=F, line=-18, adj=0, cex=0.9)

plot(medFA$fA,medFA$Ca,
     ylab="",
     xlab="",
     ylim=c(0,1.5),
     xlim=c(0,1),
     type="l",
     lwd=2,
     xaxt="n",
     yaxt="n")

axis(side=1,at=c(0,0.25,0.5,0.75,1), cex.axis=1.6)

axis(side=2, at=c(0,0.5,1,1.5), cex.axis=1.6)

mtext(expression(paste("Adult")), side=3, outer=F, line=1, adj=0.5, cex=1.2)
mtext(expression(paste(bold("(c)"))), side=1, outer=F, line=-18, adj=0, cex=0.9)

plot(medFA$fA,medFA$P,
     ylab="",
     xlab="",
     ylim=c(0.5,4.5),
     xlim=c(0,1),
     type="l",
     lwd=2,
     xaxt="n",
     yaxt="n")

axis(side=1,at=c(0,0.25,0.5,0.75,1), cex.axis=1.6)

axis(side=2, at=c(1,2,3,4), cex.axis=1.6)

mtext(expression(paste("Predator")), side=3, outer=F, line=1, adj=0.5, cex=1.2)
mtext(expression(paste(bold("(d)"))), side=1, outer=F, line=-18, adj=0, cex=0.9)

mtext(text=expression(paste("Fishing pressure on adults (", ~f[A], ")")), 
      side=1, outer=T, line=-1.5, adj=0.5, las=1, cex=1.25)

mtext(expression(paste("Equilibrium biomass density ", "[", g ~m^{-3}, "]")), las=3, side=2, outer=T, line=1, adj=0.5, cex=1.25)

mtext(expression(paste(  italic(21*degree ), "C", )), side=4, outer=T, line=0.6, adj=0.5, cex=1.25, las=0)
```

### Figure S3: Intermediate temp fishing on predator and adult consumer (filename: FigS3.pdf)
```{r}
pdf("FigS3.pdf", width = 5.5, height = 4, useDingbats=FALSE)
par(mfrow=c(1,1), 
    xaxs="i", 
    yaxs="i", 
    pty="s", 
    mar=c(3,0,2,0),
    oma=c(1.5,0,0.2,5.5))

plot(BIF2_LP_294K$fA,BIF2_LP_294K$fP,
     type="l",
     ylim=c(0,0.051),
     xlim=c(0,1),
     ylab="",
     xlab="",
     col="#e6550d")

polygon(c(0,0.0075,0.01,0.01125,0.0125,0.01875,0.025,0.05,0.06,0.08,0.1,0.13,0.16532346,0), c(tail(medFP_filt$fP,n=1),0.0063656929,0.008702787,0.0097863931,0.010818681,0.015323396,0.018962198,0.028433619,0.030876614,0.034506333,0.037056205,0.039686984,0.04172483,1),
        col="#fdae6b",
        border=NA)

mtext(expression(paste(  italic(21*degree ), "C", )), side=3, outer=F, line=0.6, adj=0.5, cex=1, las=1)

polygon(c(BIF2_LP_294K$fA[BIF2_LP_294K$fA>=0], max(BIF2_LP_294K$fA), 0), c(BIF2_LP_294K$fP[BIF2_LP_294K$fA>=0], 1, 1), col="#e6550d",border=NA)

polygon(c(max(BIF2_LP_294K$fA), 0.6, 0), c(max(BIF2_LP_294K$fP), max(BIF2_LP_294K$fP), 1), col="#e6550d",border=NA)

mtext(text=expression(paste("Fishing pressure on adults (", ~f[A], ")")), side=1, outer=T, line=0, adj=0.5, las=1)

mtext(text=expression(paste("Fishing pressure on predators (", ~f[P], ")")), side=2, outer=T, line=-2.5, adj=0.5, las=3)

par(xpd=NA)

legend(x="topright",
       inset=c(-0.7,0),
       title="Community composition",
       title.adj=0.5,
       title.col="gray",
       legend = c("C-R","P-C-R/C-R","P-C-R","Cyclic P-C-R"), 
       fill = c("#e6550d","#fdae6b","white","gray"),
       bty="n")
```

### Figure S4: Temp effect on population level net energy production of predators (filename: FigS4.png)

```{r}
tempeffect <- readMat("Temp_nettobioprod.mat")

tempeffect <- as.data.frame(t(tempeffect$h))

tempeffect <- tempeffect[-c(1:4,7,15,16,17)]

colnames(tempeffect) <- c("mr","rj","mj","mp","ma","nj","na","np","rp")

temp <- readMat("Temp_nettobioprod.mat")

temp <- as.data.frame(t(temp$x))
```

```{r}
par(cex=1.2, mar=c(5,4.5,4,4))
plot(temp$V5,tempeffect$np,
     type="l",
     lwd=5,
     xlim=c(285,300),
     ylim=c(0.010,0.025),
     xlab="Temperature [K]",
     ylab=expression(paste("Biomass x", ~Time^{-1}, "")))

abline(v=291.15, lty="dashed")

abline(v=297.15, lty="dashed")
```

### Figure S5: Ratio of Juvenile Consumer to adult consumers at $18 ^\circ C$ and $24 ^\circ C$ (filename: FigS5.png)

```{r}
lowratio <- data.frame(lowFP_filt$Ca/lowFP_filt$Cj)

lowratio <- cbind(lowratio,lowFP_filt$fP)

lowratio["D"] <- "S" 

colnames(lowratio) <- c("Ratio","fP","D")

lowratio$D[(which(lowratio[2]==max(lowratio[2]))+1):nrow(lowratio)] <- "U"

lowratio$D <- factor(as.factor(lowratio$D), levels = c(levels(as.factor(lowratio$D))))

highratio <- data.frame(highFP_filt$Ca/highFP_filt$Cj)

highratio <- cbind(highratio,highFP_filt$fP)

highratio["D"] <- "S" 

colnames(highratio) <- c("Ratio","fP","D")

highratio$D[(which(highratio[2]==max(highratio[2]))+1):nrow(highratio)] <- "U"
```

```{r}
par(mfrow=c(1,2))
plot(lowratio$fP[lowratio$D=="S"],lowratio$Ratio[lowratio$D=="S"],
     ylab="",
     xlab="",
    xlim=c(0,0.03),
     type="l",
     ylim=c(0,8),
     lwd=2,
    xaxt="n",
    yaxt="n",
    main=expression(paste(  italic(18*degree ), "C", )))

axis(side= 1, at = c(0,0.01,0.02,0.03),cex.axis=1.6)
rug(x = c(0,0.005,0.015,0.025), ticksize = -0.025, side = 1)

axis(side=2, at = c(0,2,4,6,8), cex.axis=1.6)

mtext(expression(paste(bold("(a)"))), side=1, outer=F, line=-16.5, adj=0, cex=0.9)

points(lowratio$fP[lowratio$D=="dot"],lowratio$Ratio[lowratio$D=="dot"],
      type="l",
       lty=1,
      lwd=2)

points(lowratio$fP[lowratio$D=="U"],lowratio$Ratio[lowratio$D=="U"],
      xlim=c(0,0.025),
     type="l",
     col="red")

segments(tail(lowratio$fP,n=1), tail(lowratio$Ratio,n=1), x1=1,y1=tail(lowratio$Ratio),lwd=2)

mtext(text=expression(paste("Fishing pressure on predators (", ~f[P], ")")), side=1, outer=T, line=-1.5, adj=0.5, las=1, cex=1.25)

mtext(expression(paste("Adult:Juvenile ratio")), las=3, side=2, outer=F, line=2.5, adj=0.5, cex=1.25)

plot(highratio$fP[highratio$D=="S"],highratio$Ratio[highratio$D=="S"],
     ylab="",
     xlab="",
    xlim=c(0,0.03),
     type="l",
     ylim=c(0,8),
     lwd=2,
    xaxt="n",
    yaxt="n",
    main=expression(paste(  italic(24*degree ), "C", )))

axis(side= 1, at = c(0,0.01,0.02,0.03),cex.axis=1.6)
rug(x = c(0,0.005,0.015,0.025), ticksize = -0.025, side = 1)

axis(side=2, at = c(0,2,4,6,8), cex.axis=1.6)

mtext(expression(paste(bold("(b)"))), side=1, outer=F, line=-16.5, adj=0, cex=0.9)

points(highratio$fP[highratio$D=="dot"],highratio$Ratio[highratio$D=="dot"],
      type="l",
       lty=2,
      lwd=2)

points(highratio$fP[highratio$D=="U"],highratio$Ratio[highratio$D=="U"],
      xlim=c(0,0.025),
     type="l",
     col="red")

segments(tail(highratio$fP,n=1), tail(highratio$Ratio,n=1), x1=1,y1=tail(highratio$Ratio),lwd=2)
```

### Figure S6: Produced in matlab (filename: FigS6.png)

![](figS6.png){width=80% height=400}

### Figure S7: Population level net energy production rate of juvenile consumers as a function of the fishing pressure on adult consumers at $18 ^\circ C$ and $24 ^\circ C$ (filename: FigS7.png)

```{r}
#291K
lowUF_FA <- readMat("291K_FA.mat")

lowUF_FA <- as.data.frame(t(lowUF_FA$h))

lowUF_FA <- lowUF_FA[-c(1:4,7,15,16,17)]

colnames(lowUF_FA) <- c("mr","rj","mj","mp","ma","nj","na","np","rp")

lowUF_FA <- cbind(lowFA[-c(1:4,6)],lowUF_FA[1:70,1:8])

hopf.start <- 0.0491931
hopf.stop <- 0.45588837

lowUF_FA["D"] <- "S1"
lowUF_FA$D[which(lowUF_FA[1]>=hopf.start):which(lowUF_FA[1]>=hopf.stop)+1] <- "U"
lowUF_FA$D[50:nrow(lowUF_FA)] <- "S2"

lowUF_FA_IR_MR <- lowUF_FA$mr/lowFA$Cj

lowUF_FA_IR_RJ <- lowUF_FA$rj/lowFA$Ca

lowUF_FA_IR_NJ <- lowUF_FA$nj/lowFA$Cj

lowUF_FA_IR_NA <- lowUF_FA$na/lowFA$Ca

lowUF_FA_IR_NP <- lowUF_FA$np/lowFA$P

lowUF_FA_IR_MP <- lowUF_FA$mp/lowFA$P

lowUF_FA_FR <- data.frame(lowUF_FA$mj/lowFA$P)

lowUF_FA_FR <- cbind(lowUF_FA[-c(2,3,4,5,6,7,8,9)],lowUF_FA_FR)

#294K
medUF_FA <- readMat("294K_FA.mat")

medUF_FA <- as.data.frame(t(medUF_FA$h))

medUF_FA <- medUF_FA[-c(1:4,7,15,16,17)]

colnames(medUF_FA) <- c("mr","rj","mj","mp","ma","nj","na","np","rp")

medUF_FA <- cbind(medFA[-c(1:4,6)],medUF_FA[1:60,1:8])

medUF_FA <- 
  medUF_FA %>% 
  filter(fA <= 1)

medUF_FA_IR_MR <- medUF_FA$mr/medFA$Cj[medFA$fA <= 1]

medUF_FP_IR_RJ <- medUF_FA$rj/medFA$Ca[medFA$fA <= 1]

medUF_FP_IR_MJ <- medUF_FA$mj/medFA$Cj[medFA$fA <= 1]

medUF_FP_IR_NJ <- medUF_FA$nj/medFA$Cj[medFA$fA <= 1]

medUF_FP_IR_NA <- medUF_FA$na/medFA$Ca[medFA$fA <= 1]

medUF_FP_IR_NP <- medUF_FA$np/medFA$P[medFA$fA <= 1]

medUF_FP_IR_MP <- medUF_FA$mp/medFA$P[medFA$fA <= 1]

#297K
highUF_FA <- readMat("297K_FA.mat")

highUF_FA <- as.data.frame(t(highUF_FA$h))

highUF_FA <- highUF_FA[-c(1:4,7,15,16,17)]

colnames(highUF_FA) <- c("mr","rj","mj","mp","ma","nj","na","np","rp")

highUF_FA <- cbind(highFA[-c(1:4,6)],highUF_FA[1:60,1:8])

highUF_FA_IR_MR <- highUF_FA$mr/highFA$Cj

highUF_FA_IR_RJ <- highUF_FA$rj/highFA$Ca

highUF_FA_IR_FR <- highUF_FA$mj/highFA$P

highUF_FA_IR_NJ <- highUF_FA$nj/highFA$Cj

highUF_FA_IR_NA <- highUF_FA$na/highFA$Ca

highUF_FA_IR_NP <- highUF_FA$np/highFA$P

highUF_FA_IR_MP <- highUF_FA$mp/highFA$P
```


```{r}
par(mfrow=c(1,2))
plot(lowUF_FA$fA[lowUF_FA$D=="S1"],lowUF_FA$nj[lowUF_FA$D=="S1"],
     type="l",
     col="black",
     lwd=5,
     xlim=c(0,1),
     xlab="",
     ylab="",
     ylim=c(0.2,0.4),
     main=expression(paste(  italic(18*degree ), "C", )))

points(lowUF_FA$fA[lowUF_FA$D=="U"],lowUF_FA$nj[lowUF_FA$D=="U"],
       type="l",
       lty="11",
       lwd=2,
       col="black")

points(lowUF_FA$fA[lowUF_FA$D=="S2"],lowUF_FA$nj[lowUF_FA$D=="S2"],
       type="l",
       lwd=5)

mtext(expression(paste("Biomass x", ~Time^{-1}, "")), las=3, side=2, outer=F, line=2, adj=0.5, cex=1.25)

plot(highUF_FA$fA,highUF_FA$nj,
     type="l",
     col="black",
     lwd=5,
     xlim=c(0,1),
     xlab="",
     ylab="",
     ylim=c(0.2,0.4),
     main=expression(paste(  italic(24*degree ), "C", )))

mtext(text=expression(paste("Fishing pressure on adults (", ~f[A], ")")), side=1, outer=T, line=-1.5, adj=0.5, las=1, cex=1.25)


```
### Figure S8: Cycles in juvenile consumer and predator biomass density (filename: FigS8.png)

```{r}
hopf291K <- readMat("291K_FA_0.2.mat")
hopf291Ktime <- as.data.frame(hopf291K$t)
hopf291Ky <- as.data.frame(hopf291K$y)

hopf291K <- cbind(hopf291Ktime,hopf291Ky)

hopf291K <- hopf291K[500750:500809,1:5]

colnames(hopf291K) <- c("t","Rs","Cj","Ca","P")

plot(tail(hopf291K$t,n=150),tail(hopf291K$Cj,n=150),
     type="l",
     ylim=c(0,5),
     ylab=expression(paste("Biomass density ", "[", g ~m^{-3}, "]")),
     xlab="Time [days]",
     col="red",
     lwd=2)

points(tail(hopf291K$t,n=150),tail(hopf291K$P,n=150),
       type="l",
       col="blue",
       lwd=2)

A <- hopf291K$t[which.min(tail(hopf291K$P,n=150))]
B <- hopf291K$t[which.max(tail(hopf291K$P,n=150))]

C <- hopf291K$t[which.min(hopf291K$Cj)]
D <- hopf291K$t[which.max(hopf291K$Cj)]

abline(v = A, lty=2)
abline(v = B, lty=2)
abline(v = C, lty=3)
abline(v = D, lty=3)

legend("topright", y=4, legend=c("Predator biomass density","Juvenile biomass density"), 
       lty=1,
       lwd=2,
       col=c("blue","red"),
       bty="n")
```


### Figure S9: Population level feeding rate of predator (filename: FigS9.png)

```{r}
par(mfrow=c(1,2))
plot(lowUF_FA_FR$fA[lowUF_FA_FR$D=="S1"],lowUF_FA_FR$lowUF_FA.mj.lowFA.P[lowUF_FA_FR$D=="S1"],
     type="l",
     col="black",
     lwd=5,
     xlim=c(0,1),
     ylim=c(0.07,0.13),
     xlab="",
     ylab="",
     main=expression(paste(  italic(18*degree ), "C", )))

points(lowUF_FA_FR$fA[lowUF_FA_FR$D=="U"],lowUF_FA_FR$lowUF_FA.mj.lowFA.P[lowUF_FA_FR$D=="U"],
       type="l",
       lty="11",
       lwd=3)

points(lowUF_FA_FR$fA[lowUF_FA_FR$D=="S2"],lowUF_FA_FR$lowUF_FA.mj.lowFA.P[lowUF_FA_FR$D=="S2"],
       type="l",
       lwd=5)


mtext(expression(paste(bold("(a)"))), side=1, outer=F, line=-16.5, adj=0, cex=0.9)

mtext(expression(paste("Biomass x", ~Time^{-1}, "")), las=3, side=2, outer=F, line=2, adj=0.5, cex=1.25)

plot(highUF_FA$fA,highUF_FA_IR_FR,
     type="l",
     col="black",
     lwd=5,
     xlim=c(0,1),
     ylim=c(0.07,0.13),
     xlab="",
     ylab="",
     main=expression(paste(  italic(24*degree ), "C", )))

mtext(expression(paste(bold("(b)"))), side=1, outer=F, line=-16.5, adj=0, cex=0.9)

mtext(text=expression(paste("Fishing pressure on adults (", ~f[A], ")")), side=1, outer=T, line=-1.5, adj=0.5, las=1, cex=1.25)
```
### Figure S10: Fishing on adult consumers when the predators are extinct (filename: FigS10.pdf)

```{r}
lowFA_NP <- readMat("291K_FA_NP.mat")
lowFA_NP <- as.data.frame(t(lowFA_NP$x))
colnames(lowFA_NP) <- c("Rs","Cj","Ca","P","fA")

highFA_NP <- readMat("297K_FA_NP.mat")
highFA_NP <- as.data.frame(t(highFA_NP$x))
colnames(highFA_NP) <- c("Rs","Cj","Ca","P","fA")
```

```{r}
pdf("FigS10.pdf", width = 12, height = 6, useDingbats=FALSE)
par(mfrow=c(2,4), mar=c(3.1,2.1,2.5,2), omi=c(0.4,0.4,0.2,0.4))

plot(highFA_NP$fA,highFA_NP$Rs,
     ylab="",
     xlab="",
     ylim=c(2,3),
     xlim=c(0,1),
     type="l",
     lwd=2,
     xaxt="n",
     yaxt="n")

axis(side=1,at=c(0,0.25,0.5,0.75,1), cex.axis=1.6)

axis(side=2, at=c(2,2.5,3), cex.axis=1.6)

mtext(expression(paste("Resource")), side=3, outer=F, line=1, adj=0.5, cex=1.2)
mtext(expression(paste(bold("(a)"))), side=1, outer=F, line=-16.5, adj=0, cex=0.9)

plot(highFA_NP$fA,highFA_NP$Cj,
     ylab="",
     xlab="",
     ylim=c(0.5,3.5),
     xlim=c(0,1),
     type="l",
     lwd=2,
     xaxt="n",
     yaxt="n")

axis(side=1,at=c(0,0.25,0.5,0.75,1), cex.axis=1.6)

axis(side=2, at=c(0.5,1.5,2.5,3.5), cex.axis=1.6)

mtext(expression(paste("Juvenile Consumer")), side=3, outer=F, line=1, adj=0.5, cex=1.2)
mtext(expression(paste(bold("(b)"))), side=1, outer=F, line=-16.5, adj=0, cex=0.9)

plot(highFA_NP$fA,highFA_NP$Ca,
     ylab="",
     xlab="",
     ylim=c(0,6.5),
     xlim=c(0,1),
     type="l",
     lwd=2,
     xaxt="n",
     yaxt="n")

axis(side=1,at=c(0,0.25,0.5,0.75,1), cex.axis=1.6)

axis(side=2, at=c(0,2,4,6), cex.axis=1.6)

mtext(expression(paste("Adult Consumer")), side=3, outer=F, line=1, adj=0.5, cex=1.2)
mtext(expression(paste(bold("(c)"))), side=1, outer=F, line=-16.5, adj=0, cex=0.9)

plot(highFA_NP$fA,highFA_NP$P,
     ylab="",
     xlab="",
     ylim=c(0,0.5),
     xlim=c(0,1),
     type="l",
     lwd=2,
     xaxt="n",
     yaxt="n")

axis(side=1,at=c(0,0.25,0.5,0.75,1), cex.axis=1.6)

axis(side=2, at=c(0,0.25,0.5), cex.axis=1.6)

mtext(expression(paste("Predator")), side=3, outer=F, line=1, adj=0.5, cex=1.2)
mtext(expression(paste(bold("(d)"))), side=1, outer=F, line=-16.5, adj=0, cex=0.9)

#

plot(lowFA_NP$fA,lowFA_NP$Rs,
     ylab="",
     xlab="",
     ylim=c(2,3),
     xlim=c(0,1),
     type="l",
     lwd=2,
     xaxt="n",
     yaxt="n")

axis(side=1,at=c(0,0.25,0.5,0.75,1), cex.axis=1.6)

axis(side=2, at=c(2,2.5,3), cex.axis=1.6)

mtext(expression(paste(bold("(e)"))), side=1, outer=F, line=-16.5, adj=0, cex=0.9)

plot(lowFA_NP$fA,lowFA_NP$Cj,
     ylab="",
     xlab="",
     ylim=c(0.5,3.5),
     xlim=c(0,1),
     type="l",
     lwd=2,
     xaxt="n",
     yaxt="n")

axis(side=1,at=c(0,0.25,0.5,0.75,1), cex.axis=1.6)

axis(side=2, at=c(0.5,1.5,2.5,3.5), cex.axis=1.6)

mtext(expression(paste(bold("(f)"))), side=1, outer=F, line=-16.5, adj=0, cex=0.9)

plot(lowFA_NP$fA,lowFA_NP$Ca,
     ylab="",
     xlab="",
     ylim=c(0,6.5),
     xlim=c(0,1),
     type="l",
     lwd=2,
     xaxt="n",
     yaxt="n")

axis(side=1,at=c(0,0.25,0.5,0.75,1), cex.axis=1.6)

axis(side=2, at=c(0,2,4,6), cex.axis=1.6)

mtext(expression(paste(bold("(g)"))), side=1, outer=F, line=-16.5, adj=0, cex=0.9)

plot(lowFA_NP$fA,lowFA_NP$P,
     ylab="",
     xlab="",
     ylim=c(0,0.5),
     xlim=c(0,1),
     type="l",
     lwd=2,
     xaxt="n",
     yaxt="n")

axis(side=1,at=c(0,0.25,0.5,0.75,1), cex.axis=1.6)

axis(side=2, at=c(0,0.25,0.5), cex.axis=1.6)

mtext(expression(paste(bold("(h)"))), side=1, outer=F, line=-16.5, adj=0, cex=0.9)


mtext(expression(paste("Equilibrium biomass density ", "[", g ~m^{-3}, "]")), las=3, side=2, outer=T, line=0.8, adj=0.5, cex=1.25)

mtext(text=expression(paste("Fishing pressure on adults (", ~f[A], ")")), side=1, outer=T, line=1.2, adj=0.5, las=1, cex=1.25)

mtext(expression(paste(  italic(24*degree ), "C", )), side=4, outer=T, line=0.6, adj=0.75, cex=1.25, las=0)
mtext(expression(paste(  italic(18*degree ), "C", )), side=4, outer=T, line=0.6, adj=0.25, cex=1.25, las=0)
```


### Figure S11: Juvenile equilibrium biomass when fishing on both adult consumers and predators (filename: FigS11.png)

```{r}
BIF2_LP_291K_UF  <- readMat("291K_2BIF_LP.mat")
BIF2_LP_291K_UF <- as.data.frame(t(BIF2_LP_291K_UF$x))

BIF2_LP_291K_UF1 <- readMat("291K_2BIF_UF1.mat")
BIF2_LP_291K_UF1 <- as.data.frame(t(BIF2_LP_291K_UF1$x)) # txe stable and unstable coexistence

BIF2_LP_291K_UF1 <- BIF2_LP_291K_UF1[57,1:4]

BIF2_LP_291K_UF2 <- readMat("291K_2BIF_UF2.mat")
BIF2_LP_291K_UF2 <- as.data.frame(t(BIF2_LP_291K_UF2$x)) # txe stable and unstable coexistence

BIF2_LP_291K_UF2 <- BIF2_LP_291K_UF2[39,1:4]

BIF2_LP_291K_UF3 <- readMat("291K_2BIF_UF3.mat")
BIF2_LP_291K_UF3 <- as.data.frame(t(BIF2_LP_291K_UF3$x)) # txe stable and unstable coexistence

BIF2_LP_291K_UF3 <- BIF2_LP_291K_UF3[32,1:4]

BIF2_LP_291K_UF4 <- readMat("291K_2BIF_UF4.mat")
BIF2_LP_291K_UF4 <- as.data.frame(t(BIF2_LP_291K_UF4$x)) # txe stable and unstable coexistence

BIF2_LP_291K_UF4 <- BIF2_LP_291K_UF4[28,1:4]

BIF2_LP_291K_UF5 <- readMat("291K_2BIF_UF5.mat")
BIF2_LP_291K_UF5 <- as.data.frame(t(BIF2_LP_291K_UF5$x)) # txe stable and unstable coexistence

BIF2_LP_291K_UF5 <- BIF2_LP_291K_UF5[5,1:4]

BIF2_LP_291K_UF6 <- readMat("291K_2BIF_UF6.mat")
BIF2_LP_291K_UF6 <- as.data.frame(t(BIF2_LP_291K_UF6$x)) # txe stable and unstable coexistence

BIF2_LP_291K_UF6 <- BIF2_LP_291K_UF6[21,1:4]

BIF2_LP_291K_UF7 <- readMat("291K_2BIF_UF7.mat")
BIF2_LP_291K_UF7 <- as.data.frame(t(BIF2_LP_291K_UF7$x)) # txe stable and unstable coexistence

BIF2_LP_291K_UF7 <- BIF2_LP_291K_UF7[27,1:4]

BIF2_LP_291K_UF8 <- readMat("291K_2BIF_UF8.mat")
BIF2_LP_291K_UF8 <- as.data.frame(t(BIF2_LP_291K_UF8$x)) # txe stable and unstable coexistence

BIF2_LP_291K_UF8 <- BIF2_LP_291K_UF8[48,1:4]

BIF2_LP_291K_UF9 <- readMat("291K_2BIF_UF9.mat")
BIF2_LP_291K_UF9 <- as.data.frame(t(BIF2_LP_291K_UF9$x)) # txe stable and unstable coexistence

BIF2_LP_291K_UF9 <- BIF2_LP_291K_UF9[11,1:4]

BIF2_LP_291K_UF10 <- readMat("291K_2BIF_UF10.mat")
BIF2_LP_291K_UF10 <- as.data.frame(t(BIF2_LP_291K_UF10$x)) # txe stable and unstable coexistence

BIF2_LP_291K_UF10 <- BIF2_LP_291K_UF10[8,1:4]

BIF2_LP_291K_UF11 <- readMat("291K_2BIF_UF11.mat")

BIF2_LP_291K_UF11 <- as.data.frame(t(BIF2_LP_291K_UF11$x)) # txe stable and unstable coexistence

BIF2_LP_291K_UF11 <- BIF2_LP_291K_UF11[4,1:4]

BIF2_LP_291K_UF <- BIF2_LP_291K_UF[-c(5,6)]

BIF2_LP_291K_UF <- rbind(BIF2_LP_291K_UF,BIF2_LP_291K_UF1,BIF2_LP_291K_UF2,BIF2_LP_291K_UF3,BIF2_LP_291K_UF4,BIF2_LP_291K_UF5,BIF2_LP_291K_UF6,BIF2_LP_291K_UF7,BIF2_LP_291K_UF8,BIF2_LP_291K_UF9,BIF2_LP_291K_UF10,BIF2_LP_291K_UF11)

colnames(BIF2_LP_291K_UF) <- c("Rs","Cj","Ca","P")

fA <- c(0.15,0.2,0.25,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1)
fP <- c(0.042999276,0.044253699,0.044925518,0.045282786,0.045501325,0.045380611,0.045090779,0.044707454,0.044268926,0.043796382,0.043302308)

fcont <- data.frame(fA,fP)

f <- rbind(BIF2_LP_291K,fcont)

BIF2_LP_291K_UF <- cbind(BIF2_LP_291K,BIF2_LP_291K_UF[1:289,1:4])


```



```{r}
BIF2_LP_297K_UF  <- readMat("297K_2BIF_LP.mat")
BIF2_LP_297K_UF <- as.data.frame(t(BIF2_LP_297K_UF$x))

BIF2_LP_297K_UF1 <- readMat("297K_2BIF_UF1.mat")
BIF2_LP_297K_UF1 <- as.data.frame(t(BIF2_LP_297K_UF1$x)) # txe stable and unstable coexistence

BIF2_LP_297K_UF1 <- BIF2_LP_297K_UF1[56,1:4]

BIF2_LP_297K_UF2 <- readMat("297K_2BIF_UF2.mat")
BIF2_LP_297K_UF2 <- as.data.frame(t(BIF2_LP_297K_UF2$x)) # txe stable and unstable coexistence

BIF2_LP_297K_UF2 <- BIF2_LP_297K_UF2[56,1:4]

BIF2_LP_297K_UF3 <- readMat("297K_2BIF_UF3.mat")
BIF2_LP_297K_UF3 <- as.data.frame(t(BIF2_LP_297K_UF3$x)) # txe stable and unstable coexistence

BIF2_LP_297K_UF3 <- BIF2_LP_297K_UF3[60,1:4]

BIF2_LP_297K_UF4 <- readMat("297K_2BIF_UF4.mat")
BIF2_LP_297K_UF4 <- as.data.frame(t(BIF2_LP_297K_UF4$x)) # txe stable and unstable coexistence

BIF2_LP_297K_UF4 <- BIF2_LP_297K_UF4[30,1:4]

BIF2_LP_297K_UF5 <- readMat("297K_2BIF_UF5.mat")
BIF2_LP_297K_UF5 <- as.data.frame(t(BIF2_LP_297K_UF5$x)) # txe stable and unstable coexistence

BIF2_LP_297K_UF5 <- BIF2_LP_297K_UF5[33,1:4]

BIF2_LP_297K_UF6 <- readMat("297K_2BIF_UF6.mat")
BIF2_LP_297K_UF6 <- as.data.frame(t(BIF2_LP_297K_UF6$x)) # txe stable and unstable coexistence

BIF2_LP_297K_UF6 <- BIF2_LP_297K_UF6[35,1:4]

BIF2_LP_297K_UF7 <- readMat("297K_2BIF_UF7.mat")
BIF2_LP_297K_UF7 <- as.data.frame(t(BIF2_LP_297K_UF7$x)) # txe stable and unstable coexistence

BIF2_LP_297K_UF7 <- BIF2_LP_297K_UF7[34,1:4]

BIF2_LP_297K_UF8 <- readMat("297K_2BIF_UF8.mat")
BIF2_LP_297K_UF8 <- as.data.frame(t(BIF2_LP_297K_UF8$x)) # txe stable and unstable coexistence

BIF2_LP_297K_UF8 <- BIF2_LP_297K_UF8[29,1:4]

BIF2_LP_297K_UF9 <- readMat("297K_2BIF_UF9.mat")
BIF2_LP_297K_UF9 <- as.data.frame(t(BIF2_LP_297K_UF9$x)) # txe stable and unstable coexistence

BIF2_LP_297K_UF9 <- BIF2_LP_297K_UF9[24,1:4]

BIF2_LP_297K_UF10 <- readMat("297K_2BIF_UF10.mat")
BIF2_LP_297K_UF10 <- as.data.frame(t(BIF2_LP_297K_UF10$x)) # txe stable and unstable coexistence

BIF2_LP_297K_UF10 <- BIF2_LP_297K_UF10[22,1:4]

BIF2_LP_297K_UF <- BIF2_LP_297K_UF[-c(5,6)]

BIF2_LP_297K_UF <- rbind(BIF2_LP_297K_UF,BIF2_LP_297K_UF1,BIF2_LP_297K_UF2,BIF2_LP_297K_UF3,BIF2_LP_297K_UF4,BIF2_LP_297K_UF5,BIF2_LP_297K_UF6,BIF2_LP_297K_UF7,BIF2_LP_297K_UF8,BIF2_LP_297K_UF9,BIF2_LP_297K_UF10)

colnames(BIF2_LP_297K_UF) <- c("Rs","Cj","Ca","P")

fA297 <- c(0.037537654,0.039513913,0.040818867,0.041703036,0.042306706,0.042980507,0.043220478,0.04302708,0.042570361,0.042383176) 
fP297 <- c(0.2,0.25,0.3,0.35,0.4,0.5,0.6,0.8,0.95,1)

fcont297 <- data.frame(fA297,fP297)

colnames(fcont297) <- c("fP","fA")

f297 <- rbind(BIF2_LP_297K)

BIF2_LP_297K_UF<- cbind(BIF2_LP_297K,BIF2_LP_297K_UF[1:212,1:4])
```



```{r}
par(mfrow=c(2,2), mar=c(2,1,1,1), oma=c(4,4,1,1))
plot(BIF2_LP_297K_UF$fP,BIF2_LP_297K_UF$Cj, type="l",
     ylab="",
     xlab="",
     ylim=c(1,4),
     xlim=c(0,0.05),
     main="Juvenile Consumer",
     lwd=2,
     xaxt="n")

mtext(expression(paste(bold("(a)"))), side=1, outer=F, line=-9.5, adj=0, cex=0.9)

plot(BIF2_LP_297K_UF$fA,BIF2_LP_297K_UF$Cj, type="l",
     ylab="",
     xlab="",
     xlim=c(0,1),
     ylim=c(1,4),
     main="Juvenile Consumer",
     lwd=2,
     xaxt="n",
     yaxt="n")

mtext(expression(paste(bold("(b)"))), side=1, outer=F, line=-9.5, adj=0, cex=0.9)

mtext(expression(paste(  italic(24*degree ), "C", )), side=4, outer=F, line=0.5, adj=0.5, cex=1, las=0)

plot(BIF2_LP_291K_UF$fP,BIF2_LP_291K_UF$Cj, type="l",
     ylab="",
     xlab="",
     xlim=c(0,0.05),
     ylim=c(1,4),
     lwd=2)

mtext(expression(paste(bold("(c)"))), side=1, outer=F, line=-9.5, adj=0, cex=0.9)

plot(BIF2_LP_291K_UF$fA,BIF2_LP_291K_UF$Cj, type="l",
     ylab="",
     xlab="",
     ylim=c(1,4),
     xlim=c(0,1),
     yaxt="n",
     lwd=2)

mtext(expression(paste(bold("(d)"))), side=1, outer=F, line=-9.5, adj=0, cex=0.9)



mtext(expression(paste(  italic(18*degree ), "C", )), side=4, outer=F, line=0.5, adj=0.5, cex=1, las=0)
mtext(expression(paste("Equilibrium biomass density ", "[", g ~m^{-3}, "]")), las=3, side=2, outer=T, line=2, adj=0.5, cex=1)

mtext(expression(paste("Fishing pressure on adults (", ~f[A], ")")), las=1, side=1, outer=T, line=1, adj=0.9, cex=1)
mtext(expression(paste("Fishing pressure on predators (", ~f[P], ")")), las=1, side=1, outer=T, line=1, adj=0.05, cex=1)
```



### Figure S12: Population level net energy production rate of juvenile consumers when fishing on both adult consumers and predators (filename: FigS12.png)

```{r}
BIF2_LP_291K  <- readMat("291K_2BIF_LP.mat")
BIF2_LP_291K <- as.data.frame(t(BIF2_LP_291K$x)) # the stable and unstable coexistence

colnames(BIF2_LP_291K) <- c("Rs","Cj","Ca","P","fA","fP")

BIF2_LP_291K <- 
  BIF2_LP_291K %>% 
  filter(P > 0)

BIF2_LP_291K_UF  <- readMat("291K_2BIF_LP.mat")
BIF2_LP_291K_UF <- as.data.frame(t(BIF2_LP_291K_UF$h))

BIF2_LP_291K_UF1 <- readMat("291K_2BIF_UF1.mat")
BIF2_LP_291K_UF1 <- as.data.frame(t(BIF2_LP_291K_UF1$h)) # the stable and unstable coexistence

BIF2_LP_291K_UF1 <- BIF2_LP_291K_UF1[57,1:17]

BIF2_LP_291K_UF2 <- readMat("291K_2BIF_UF2.mat")
BIF2_LP_291K_UF2 <- as.data.frame(t(BIF2_LP_291K_UF2$h)) # the stable and unstable coexistence

BIF2_LP_291K_UF2 <- BIF2_LP_291K_UF2[39,1:17]

BIF2_LP_291K_UF3 <- readMat("291K_2BIF_UF3.mat")
BIF2_LP_291K_UF3 <- as.data.frame(t(BIF2_LP_291K_UF3$h)) # the stable and unstable coexistence

BIF2_LP_291K_UF3 <- BIF2_LP_291K_UF3[32,1:17]

BIF2_LP_291K_UF4 <- readMat("291K_2BIF_UF4.mat")
BIF2_LP_291K_UF4 <- as.data.frame(t(BIF2_LP_291K_UF4$h)) # the stable and unstable coexistence

BIF2_LP_291K_UF4 <- BIF2_LP_291K_UF4[28,1:17]

BIF2_LP_291K_UF5 <- readMat("291K_2BIF_UF5.mat")
BIF2_LP_291K_UF5 <- as.data.frame(t(BIF2_LP_291K_UF5$h)) # the stable and unstable coexistence

BIF2_LP_291K_UF5 <- BIF2_LP_291K_UF5[5,1:17]

BIF2_LP_291K_UF6 <- readMat("291K_2BIF_UF6.mat")
BIF2_LP_291K_UF6 <- as.data.frame(t(BIF2_LP_291K_UF6$h)) # the stable and unstable coexistence

BIF2_LP_291K_UF6 <- BIF2_LP_291K_UF6[21,1:17]

BIF2_LP_291K_UF7 <- readMat("291K_2BIF_UF7.mat")
BIF2_LP_291K_UF7 <- as.data.frame(t(BIF2_LP_291K_UF7$h)) # the stable and unstable coexistence

BIF2_LP_291K_UF7 <- BIF2_LP_291K_UF7[27,1:17]

BIF2_LP_291K_UF8 <- readMat("291K_2BIF_UF8.mat")
BIF2_LP_291K_UF8 <- as.data.frame(t(BIF2_LP_291K_UF8$h)) # the stable and unstable coexistence

BIF2_LP_291K_UF8 <- BIF2_LP_291K_UF8[48,1:17]

BIF2_LP_291K_UF9 <- readMat("291K_2BIF_UF9.mat")
BIF2_LP_291K_UF9 <- as.data.frame(t(BIF2_LP_291K_UF9$h)) # the stable and unstable coexistence

BIF2_LP_291K_UF9 <- BIF2_LP_291K_UF9[11,1:17]

BIF2_LP_291K_UF10 <- readMat("291K_2BIF_UF10.mat")
BIF2_LP_291K_UF10 <- as.data.frame(t(BIF2_LP_291K_UF10$h)) # the stable and unstable coexistence

BIF2_LP_291K_UF10 <- BIF2_LP_291K_UF10[8,1:17]

BIF2_LP_291K_UF11 <- readMat("291K_2BIF_UF11.mat")

BIF2_LP_291K_UF11 <- as.data.frame(t(BIF2_LP_291K_UF11$h)) # the stable and unstable coexistence

BIF2_LP_291K_UF11 <- BIF2_LP_291K_UF11[4,1:17]

BIF2_LP_291K_UF <- BIF2_LP_291K_UF[-c(18)]

BIF2_LP_291K_UF <- rbind(BIF2_LP_291K_UF,BIF2_LP_291K_UF1,BIF2_LP_291K_UF2,BIF2_LP_291K_UF3,BIF2_LP_291K_UF4,BIF2_LP_291K_UF5,BIF2_LP_291K_UF6,BIF2_LP_291K_UF7,BIF2_LP_291K_UF8,BIF2_LP_291K_UF9,BIF2_LP_291K_UF10,BIF2_LP_291K_UF11)

BIF2_LP_291K_UF <- BIF2_LP_291K_UF[-c(1:4,7,15,16,17)]

colnames(BIF2_LP_291K_UF) <- c("mr","rj","mj","mp","ma","nj","na","np","rp")

fA <- c(0.15,0.2,0.25,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1)
fP <- c(0.042999276,0.044253699,0.044925518,0.045282786,0.045501325,0.045380611,0.045090779,0.044707454,0.044268926,0.043796382,0.043302308)

fcont <- data.frame(fA,fP)

f <- rbind(BIF2_LP_291K[-c(1:4)],fcont)

BIF2_LP_291K_UF <- cbind(f,BIF2_LP_291K_UF[1:289,1:9])

```

```{r}
BIF2_LP_297K  <- readMat("297K_2BIF_LP.mat")
BIF2_LP_297K <- as.data.frame(t(BIF2_LP_297K$x)) # the stable and unstable coexistence

colnames(BIF2_LP_297K) <- c("Rs","Cj","Ca","P","fA","fP")

BIF2_LP_297K <- 
  BIF2_LP_297K %>% 
  filter(P > 0)

BIF2_LP_297K_UF  <- readMat("297K_2BIF_LP.mat")
BIF2_LP_297K_UF <- as.data.frame(t(BIF2_LP_297K_UF$h))

#BIF2_LP_297K_UF1 <- readMat("297K_2BIF_UF1.mat")
#BIF2_LP_297K_UF1 <- as.data.frame(t(BIF2_LP_297K_UF1$h)) # the stable and unstable coexistence

#BIF2_LP_297K_UF1 <- BIF2_LP_297K_UF1[71,1:17]

BIF2_LP_297K_UF2 <- readMat("297K_2BIF_UF2.mat")
BIF2_LP_297K_UF2 <- as.data.frame(t(BIF2_LP_297K_UF2$h)) # the stable and unstable coexistence

BIF2_LP_297K_UF2 <- BIF2_LP_297K_UF2[56,1:17]

BIF2_LP_297K_UF3 <- readMat("297K_2BIF_UF3.mat")
BIF2_LP_297K_UF3 <- as.data.frame(t(BIF2_LP_297K_UF3$h)) # the stable and unstable coexistence

BIF2_LP_297K_UF3 <- BIF2_LP_297K_UF3[60,1:17]

BIF2_LP_297K_UF4 <- readMat("297K_2BIF_UF4.mat")
BIF2_LP_297K_UF4 <- as.data.frame(t(BIF2_LP_297K_UF4$h)) # the stable and unstable coexistence

BIF2_LP_297K_UF4 <- BIF2_LP_297K_UF4[30,1:17]

BIF2_LP_297K_UF5 <- readMat("297K_2BIF_UF5.mat")
BIF2_LP_297K_UF5 <- as.data.frame(t(BIF2_LP_297K_UF5$h)) # the stable and unstable coexistence

BIF2_LP_297K_UF5 <- BIF2_LP_297K_UF5[33,1:17]

BIF2_LP_297K_UF6 <- readMat("297K_2BIF_UF6.mat")
BIF2_LP_297K_UF6 <- as.data.frame(t(BIF2_LP_297K_UF6$h)) # the stable and unstable coexistence

BIF2_LP_297K_UF6 <- BIF2_LP_297K_UF6[35,1:17]

BIF2_LP_297K_UF7 <- readMat("297K_2BIF_UF7.mat")
BIF2_LP_297K_UF7 <- as.data.frame(t(BIF2_LP_297K_UF7$h)) # the stable and unstable coexistence

BIF2_LP_297K_UF7 <- BIF2_LP_297K_UF7[34,1:17]

BIF2_LP_297K_UF8 <- readMat("297K_2BIF_UF8.mat")
BIF2_LP_297K_UF8 <- as.data.frame(t(BIF2_LP_297K_UF8$h)) # the stable and unstable coexistence

BIF2_LP_297K_UF8 <- BIF2_LP_297K_UF8[29,1:17]

BIF2_LP_297K_UF9 <- readMat("297K_2BIF_UF9.mat")
BIF2_LP_297K_UF9 <- as.data.frame(t(BIF2_LP_297K_UF9$h)) # the stable and unstable coexistence

BIF2_LP_297K_UF9 <- BIF2_LP_297K_UF9[24,1:17]

BIF2_LP_297K_UF10 <- readMat("297K_2BIF_UF10.mat")
BIF2_LP_297K_UF10 <- as.data.frame(t(BIF2_LP_297K_UF10$h)) # the stable and unstable coexistence

BIF2_LP_297K_UF10 <- BIF2_LP_297K_UF10[22,1:17]

BIF2_LP_297K_UF <- BIF2_LP_297K_UF[-c(18)]

BIF2_LP_297K_UF <- rbind(BIF2_LP_297K_UF,BIF2_LP_297K_UF2,BIF2_LP_297K_UF3,BIF2_LP_297K_UF4,BIF2_LP_297K_UF5,BIF2_LP_297K_UF6,BIF2_LP_297K_UF7,BIF2_LP_297K_UF8,BIF2_LP_297K_UF9,BIF2_LP_297K_UF10)

BIF2_LP_297K_UF <- BIF2_LP_297K_UF[-c(1:4,7,15,16,17)]

colnames(BIF2_LP_297K_UF) <- c("mr","rj","mj","mp","ma","nj","na","np","rp")

fA297 <- c(0.039513913,0.040818867,0.041703036,0.042306706,0.042980507,0.043220478,0.04302708,0.042570361,0.042383176) 
fP297 <- c(0.25,0.3,0.35,0.4,0.5,0.6,0.8,0.95,1)
#0.2,
#0.037537654,
fcont297 <- data.frame(fA297,fP297)

colnames(fcont297) <- c("fP","fA")

f297 <- rbind(BIF2_LP_297K[-c(1:4)],fcont297)

BIF2_LP_297K_UF <- cbind(f297,BIF2_LP_297K_UF[1:211,1:9])
```








```{r fig.height=5, fig.width=8}
par(mfrow=c(2,2), mar=c(1,1,1,1), oma=c(4,3,1,3), cex=0.95)
plot(BIF2_LP_297K_UF$fP,BIF2_LP_297K_UF$nj,
     type="l",
     lwd=3,
     ylab="",
     xlab="",
     xaxt="n",
     xlim=c(0,0.05),
     ylim=c(0.2,0.6))

mtext(expression(paste(bold("(a)"))), side=1, outer=F, line=-10, adj=0, cex=0.9)

plot(BIF2_LP_297K_UF$fA,BIF2_LP_297K_UF$nj,
     type="l",
     lwd=3,
     ylab="",
     xlab="",
     xaxt="n",
     yaxt="n",
     ylim=c(0.2,0.6))

mtext(expression(paste(bold("(b)"))), side=1, outer=F, line=-10, adj=0, cex=0.9)

plot(BIF2_LP_291K_UF$fP,BIF2_LP_291K_UF$nj,
     type="l",
     lwd=3,
     ylab="",
     xlab="",
     xlim=c(0,0.05),
     ylim=c(0.2,0.6))

mtext(expression(paste(bold("(c)"))), side=1, outer=F, line=-10, adj=0, cex=0.9)

plot(BIF2_LP_291K_UF$fA,BIF2_LP_291K_UF$nj,
     type="l",
     lwd=3,
     ylab="",
     xlab="",
     yaxt="n",
     ylim=c(0.2,0.6))

mtext(expression(paste(bold("(d)"))), side=1, outer=F, line=-10, adj=0, cex=0.9)

mtext(expression(paste("Biomass x", ~Time^{-1}, "")), las=3, side=2, outer=T, line=1, adj=0.5, cex=1.1)

mtext(expression(paste(  italic(24*degree ), "C", )), side=4, outer=T, line=0, adj=0.75, cex=1.1, las=0)
mtext(expression(paste(  italic(18*degree ), "C", )), side=4, outer=T, line=0, adj=0.25, cex=1.1, las=0)

mtext(expression(paste("Fishing pressure on adults (", ~f[A], ")")), las=1, side=1, outer=T, line=2, adj=0.95, cex=1.1)
mtext(expression(paste("Fishing pressure on predators (", ~f[P], ")")), las=1, side=1, outer=T, line=2, adj=0.1, cex=1.1)
```

### Figure S13: Population level net energy prodiuction rate of juvenile consumers when fishing on predators (filename: FigS13.png)

```{r}
par(mfrow=c(1,2))
plot(lowUF_FP$fP[lowUF_FP$D=="S"],lowUF_FP$nj[lowUF_FP$D=="S"],
     type="l",
     col="black",
     lwd=5,
     xlim=c(0,0.03),
     ylim=c(0.05,0.30),
     xlab="",
     ylab="",
     main=expression(paste(  italic(18*degree ), "C", )))

points(lowUF_FP$fP[lowUF_FP$D=="dot"],lowUF_FP$nj[lowUF_FP$D=="dot"],
       type="l",
       lwd=5)

points(lowUF_FP$fP[lowUF_FP$D=="U"],lowUF_FP$nj[lowUF_FP$D=="U"],
       type="l",
       lwd=1)

mtext(expression(paste(bold("(a)"))), side=1, outer=F, line=-16.5, adj=0, cex=0.9)

segments(tail(lowUF_FP$fP,n=1), tail(lowUF_FP$nj,n=1), x1=1,y1=tail(lowUF_FP$mr,n=1),lwd=5, col="black")

mtext(expression(paste("Biomass x", ~Time^{-1}, "")), las=3, side=2, outer=F, line=2, adj=0.5, cex=1.25)

plot(highUF_FP$fP[highUF_FP$D=="S"],highUF_FP$nj[highUF_FP$D=="S"],
     type="l",
     col="black",
     lwd=5,
     xlim=c(0,0.03),
     ylim=c(0.05,0.30),
     xlab="",
     ylab="",
     main=expression(paste(  italic(24*degree ), "C", )))

points(highUF_FP$fP[highUF_FP$D=="U"],highUF_FP$nj[highUF_FP$D=="U"],
       type="l",
       lwd=1)

mtext(expression(paste(bold("(b)"))), side=1, outer=F, line=-16.5, adj=0, cex=0.9)

segments(tail(highUF_FP$fP,n=1), tail(highUF_FP$nj,n=1), x1=1,y1=tail(highUF_FP$mr,n=1),lwd=5, col="black")

mtext(text=expression(paste("Fishing pressure on predators (", ~f[P], ")")), 
      side=1, outer=T, line=-1.5, adj=0.5, las=1, cex=1.25)

```

### Figure S14: Mass-specific net energy production rate of adult consumers as a function of the fishing pressure on the predator (filename: FigS14.png)


```{r}
lowUF_FP_IR_RJ <- data.frame(lowUF_FP$rj/lowFP_filt$Ca)

lowUF_FP_IR_MR <- data.frame(lowUF_FP$mr/lowFP_filt$Cj)

lowUF_FP_IR_NA <- data.frame(lowUF_FP$na/lowFP_filt$Ca)

highUF_FP_IR_RJ <- data.frame(highUF_FP$rj/highFP_filt$Ca)

highUF_FP_IR_MR <- data.frame(highUF_FP$mr/highFP_filt$Cj)

highUF_FP_IR_NA <-data.frame(highUF_FP$na/highFP_filt$Ca)


highUF_FP_IR_MR <- cbind(highUF_FP_IR_MR,highUF_FP$fP)

highUF_FP_IR_MR["D"] <- "S" 

colnames(highUF_FP_IR_MR) <- c("Biomass density","fP","D")

highUF_FP_IR_MR$D[(which(highUF_FP_IR_MR[2]==max(highUF_FP_IR_MR[2]))+1):nrow(highUF_FP_IR_MR)] <- "U"

highUF_FP_IR_RJ <- cbind(highUF_FP_IR_RJ,highUF_FP$fP)

highUF_FP_IR_RJ["D"] <- "S" 

colnames(highUF_FP_IR_RJ) <- c("Biomass density","fP","D")

highUF_FP_IR_RJ$D[(which(highUF_FP_IR_RJ[2]==max(highUF_FP_IR_RJ[2]))+1):nrow(highUF_FP_IR_RJ)] <- "U"

lowUF_FP_IR_MR <- cbind(lowUF_FP_IR_MR,lowUF_FP$fP)

lowUF_FP_IR_MR["D"] <- "S" 

colnames(lowUF_FP_IR_MR) <- c("Biomass density","fP","D")

lowUF_FP_IR_MR$D[(which(lowUF_FP_IR_MR[2]==max(lowUF_FP_IR_MR[2]))+1):nrow(lowUF_FP_IR_MR)] <- "U"

lowUF_FP_IR_RJ <- cbind(lowUF_FP_IR_RJ,lowUF_FP$fP)

lowUF_FP_IR_RJ["D"] <- "S" 

colnames(lowUF_FP_IR_RJ) <- c("Biomass density","fP","D")

lowUF_FP_IR_RJ$D[(which(lowUF_FP_IR_RJ[2]==max(lowUF_FP_IR_RJ[2]))+1):nrow(lowUF_FP_IR_RJ)] <- "U"

lowUF_FP_IR_NA <- cbind(lowUF_FP_IR_NA,lowUF_FP$fP)

lowUF_FP_IR_NA["D"] <- "S" 

colnames(lowUF_FP_IR_NA) <- c("Biomass density","fP","D")

lowUF_FP_IR_NA$D[(which(lowUF_FP_IR_NA[2]==max(lowUF_FP_IR_NA[2]))+1):nrow(lowUF_FP_IR_NA)] <- "U"

highUF_FP_IR_NA <- cbind(highUF_FP_IR_NA,highUF_FP$fP)

highUF_FP_IR_NA["D"] <- "S" 

colnames(highUF_FP_IR_NA) <- c("Biomass density","fP","D")

highUF_FP_IR_NA$D[(which(highUF_FP_IR_NA[2]==max(highUF_FP_IR_NA[2]))+1):nrow(highUF_FP_IR_NA)] <- "U"

```

```{r}
par(mfrow=c(1,2), cex=1)
plot(lowUF_FP_IR_NA$fP[lowUF_FP_IR_NA$D=="S"],lowUF_FP_IR_NA$`Biomass density`[lowUF_FP_IR_NA$D=="S"],
     type="l",
     col="black",
     lwd=5,
     xlim=c(0,0.03),
     ylim=c(0,0.08),
     xlab="",
     ylab="",
     main=expression(paste(  italic(18*degree ), "C", )))

points(lowUF_FP_IR_NA$fP[lowUF_FP_IR_NA$D=="U"],lowUF_FP_IR_NA$`Biomass density`[lowUF_FP_IR_NA$D=="U"],
       type="l",
       col="black",
       lwd=1)

segments(tail(lowUF_FP_IR_NA$fP,n=1), tail(lowUF_FP_IR_NA$`Biomass density`,n=1), x1=1,y1=tail(lowUF_FP_IR_NA$`Biomass density`,n=1),lwd=5, col="black")

mtext(expression(paste(bold("(a)"))), side=1, outer=F, line=-16.5, adj=0, cex=0.9)

mtext(expression(paste("Biomass(Biomass x Time", ")"^{-1}, "")), las=3, side=2, outer=F, line=2, adj=0.5, cex=1.25)

plot(highUF_FP_IR_NA$fP[highUF_FP_IR_NA$D=="S"],highUF_FP_IR_NA$`Biomass density`[highUF_FP_IR_NA$D=="S"],
     type="l",
     col="black",
     lwd=5,
     xlim=c(0,0.03),
     ylim=c(0,0.08),
     xlab="",
     ylab="",
     main=expression(paste(  italic(24*degree ), "C", )))

points(highUF_FP_IR_NA$fP[highUF_FP_IR_NA$D=="U"],highUF_FP_IR_NA$`Biomass density`[highUF_FP_IR_NA$D=="U"],
       type="l",
       col="black",
       lwd=1)

segments(tail(highUF_FP_IR_NA$fP,n=1), tail(highUF_FP_IR_NA$`Biomass density`,n=1), x1=1,y1=tail(highUF_FP_IR_NA$`Biomass density`,n=1),lwd=5, col="black")

mtext(expression(paste(bold("(b)"))), side=1, outer=F, line=-16.5, adj=0, cex=0.9)

mtext(text=expression(paste("Fishing pressure on predators (", ~f[P], ")")), side=1, outer=T, line=-1.5, adj=0.5, las=1, cex=1.25)
```

### Figure S15: Mass-specific maturation abd reproduction rate when fishing on predators (filename: FigS15.png)

```{r}
par(mfrow=c(1,2))
plot(lowUF_FP_IR_MR$fP[lowUF_FP_IR_MR$D=="S"],lowUF_FP_IR_MR$`Biomass density`[lowUF_FP_IR_MR$D=="S"],
     type="l",
     ylim=c(0,0.22),
     xlim=c(0,0.03),
     col="black",
     lwd=5,
     xlab="",
     ylab="",
     main=expression(paste(  italic(18*degree ), "C", )))

legend(x= "topright", y=0.7,
       legend = c("Maturation rate","Reproductive rate"),
       col = c("Black","Gray"),
       lty=1,
       lwd=5,
       bty="n")

mtext(expression(paste(bold("(a)"))), side=1, outer=F, line=-16.5, adj=0, cex=0.9)

points(lowUF_FP_IR_MR$fP[lowUF_FP_IR_MR$D=="U"],lowUF_FP_IR_MR$`Biomass density`[lowUF_FP_IR_MR$D=="U"],
       type="l",
       col="black",
       lwd=1)

points(lowUF_FP_IR_RJ$fP[lowUF_FP_IR_RJ$D=="S"],lowUF_FP_IR_RJ$`Biomass density`[lowUF_FP_IR_RJ$D=="S"],
     type="l",
     col="gray",
     lwd=5)

points(lowUF_FP_IR_RJ$fP[lowUF_FP_IR_RJ$D=="U"],lowUF_FP_IR_RJ$`Biomass density`[lowUF_FP_IR_RJ$D=="U"],
       type="l",
       col="gray",
       lwd=1)

segments(tail(lowUF_FP_IR_MR$fP,n=1), tail(lowUF_FP_IR_MR$`Biomass density`,n=1), x1=1,y1=tail(lowUF_FP_IR_MR$`Biomass density`,n=1),lwd=5, col="black")
segments(tail(lowUF_FP_IR_RJ$fP,n=1), tail(lowUF_FP_IR_RJ$`Biomass density`,n=1), x1=1,y1=tail(lowUF_FP_IR_RJ$`Biomass density`,n=1),lwd=5, col="gray")

mtext(expression(paste("Biomass(Biomass x Time", ")"^{-1}, "")), las=3, side=2, outer=F, line=2, adj=0.5, cex=1.25)

plot(highUF_FP_IR_MR$fP[highUF_FP_IR_MR$D=="S"],highUF_FP_IR_MR$`Biomass density`[highUF_FP_IR_MR$D=="S"],
     type="l",
     ylim=c(0,0.22),
     xlim=c(0,0.03),
     col="black",
     lwd=5,
     xlab="",
     ylab="",
     main=expression(paste(  italic(24*degree ), "C", )))

mtext(expression(paste(bold("(b)"))), side=1, outer=F, line=-16.5, adj=0, cex=0.9)

points(highUF_FP_IR_MR$fP[highUF_FP_IR_MR$D=="U"],highUF_FP_IR_MR$`Biomass density`[highUF_FP_IR_MR$D=="U"],
       type="l",
       col="black",
       lwd=1)

points(highUF_FP_IR_RJ$fP[highUF_FP_IR_RJ$D=="S"],highUF_FP_IR_RJ$`Biomass density`[highUF_FP_IR_RJ$D=="S"],
     type="l",
     col="gray",
     lwd=5)

points(highUF_FP_IR_RJ$fP[highUF_FP_IR_RJ$D=="U"],highUF_FP_IR_RJ$`Biomass density`[highUF_FP_IR_RJ$D=="U"],
       type="l",
       col="gray",
       lwd=1)



mtext(text=expression(paste("Fishing pressure on predators (", ~f[P], ")")), 
      side=1, outer=T, line=-1.5, adj=0.5, las=1, cex=1.25)


segments(tail(highUF_FP_IR_MR$fP,n=1), tail(highUF_FP_IR_MR$`Biomass density`,n=1), x1=1,y1=tail(highUF_FP_IR_MR$`Biomass density`,n=1),lwd=5, col="black")
segments(tail(highUF_FP_IR_RJ$fP,n=1), tail(highUF_FP_IR_RJ$`Biomass density`,n=1), x1=1,y1=tail(highUF_FP_IR_RJ$`Biomass density`,n=1),lwd=5, col="gray")

```